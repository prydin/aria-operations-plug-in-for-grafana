/*! For license information please see module.js.LICENSE.txt */
define(["@grafana/data","@grafana/runtime","lodash","rxjs","react","@grafana/ui","@emotion/css"],((e,t,r,n,s,o,i)=>(()=>{var a={337:(e,t,r)=>{const{BinarySearchTree:n}=r(364),{BinarySearchTreeNode:s}=r(105),{AvlTree:o}=r(979),{AvlTreeNode:i}=r(724);e.exports={BinarySearchTree:n,BinarySearchTreeNode:s,AvlTree:o,AvlTreeNode:i}},979:(e,t,r)=>{const{BinarySearchTree:n}=r(364),{AvlTreeNode:s}=r(724);t.AvlTree=class extends n{constructor(e,t){if(e&&"function"!=typeof e)throw new Error("AvlTree constructor expects a compare function");super(e,t)}_balanceNode(e){if(!e)return;e.updateHeight();const t=e.getBalance();t>1?e.getLeft().hasLeft()?e.rotateRight():e.getLeft().hasRight()&&e.rotateLeftRight():t<-1&&(e.getRight().hasRight()?e.rotateLeft():e.getRight().hasLeft()&&e.rotateRightLeft()),(t<-1||t>1)&&e===this._root&&(this._root=e.getParent())}insert(e){const t=new s(e,this._compare),r=n=>{const s=this._compare(e,n.getValue());s<0?n.hasLeft()?(r(n.getLeft()),this._balanceNode(n)):(t.setParent(n),n.setLeft(t).updateHeight(),this._count+=1):s>0?n.hasRight()?(r(n.getRight()),this._balanceNode(n)):(t.setParent(n),n.setRight(t).updateHeight(),this._count+=1):n.setValue(e)};return null===this._root?(this._root=t,this._count+=1):r(this._root),this}remove(e){const t=(e,r)=>{if(null===r)return!1;const n=this._compare(e,r.getValue());if(n<0){const n=t(e,r.getLeft());return this._balanceNode(r),n}if(n>0){const n=t(e,r.getRight());return this._balanceNode(r),n}return this.removeNode(r)};return t(e,this._root)}removeNode(e){if(null===e||!(e instanceof s))return!1;if(e.isLeaf())return e.isRoot()?this._root=null:this._compare(e.getValue(),e.getParent().getValue())<0?e.getParent().setLeft(null).updateHeight():e.getParent().setRight(null).updateHeight(),this._count-=1,!0;if(!e.hasRight())return e.isRoot()?this._root=e.getLeft():this._compare(e.getValue(),e.getParent().getValue())<0?e.getParent().setLeft(e.getLeft()).updateHeight():e.getParent().setRight(e.getLeft()).updateHeight(),e.getLeft().setParent(e.getParent()),this._count-=1,!0;if(!e.hasLeft())return e.isRoot()?this._root=e.getRight():this._compare(e.getValue(),e.getParent().getValue())<0?e.getParent().setLeft(e.getRight()).updateHeight():e.getParent().setRight(e.getRight()).updateHeight(),e.getRight().setParent(e.getParent()),this._count-=1,!0;const t=this.min(e.getRight()),r=this.removeNode(t);return e.setValue(t.getValue()),this._balanceNode(e),r}}},724:(e,t)=>{const r=(e,t)=>e===t?0:e>t?1:-1;class n{constructor(e,t){if(t&&"function"!=typeof t)throw new Error("AvlTreeNode constructor expects a compare function");this._value=e,this._compare=t||r,this._left=null,this._right=null,this._parent=null,this._height=1}setValue(e){return this._value=e,this}getValue(){return this._value}setLeft(e){if(e&&!(e instanceof n))throw new Error("setLeft expects an AvlTreeNode");return this._left=e||null,this}getLeft(){return this._left}hasLeft(){return this._left instanceof n}setRight(e){if(e&&!(e instanceof n))throw new Error("setRight expects a AvlTreeNode or null");return this._right=e||null,this}getRight(){return this._right}hasRight(){return this._right instanceof n}setParent(e){if(e&&!(e instanceof n))throw new Error("setParent expects an AvlTreeNode");return this._parent=e||null,this}getParent(){return this._parent}hasParent(){return this._parent instanceof n}isRoot(){return null===this._parent}isLeaf(){return!this.hasLeft()&&!this.hasRight()}rotateLeft(){const e=this._right;return null!==e&&(e.hasLeft()&&e.getLeft().setParent(this),this._right=e.getLeft(),e.setLeft(this),e.setParent(this._parent)),this.hasParent()&&null!==e&&(this._compare(this._parent.getValue(),e.getValue())<0?this._parent.setRight(e):this._parent.setLeft(e)),this._parent=e,this.updateHeight(),this.hasParent()&&this._parent.updateHeight(),this}rotateRight(){const e=this._left;return null!==e&&(e.hasRight()&&e.getRight().setParent(this),this._left=e.getRight(),e.setRight(this),e.setParent(this._parent)),this.hasParent()&&null!==e&&(this._compare(this._parent.getValue(),e.getValue())>0?this._parent.setLeft(e):this._parent.setRight(e)),this._parent=e,this.updateHeight(),this.hasParent()&&this._parent.updateHeight(),this}rotateLeftRight(){return this.hasLeft()&&this._left.rotateLeft(),this.rotateRight(),this}rotateRightLeft(){return this.hasRight()&&this._right.rotateRight(),this.rotateLeft(),this}getLeftHeight(){return this.hasLeft()?this.getLeft().getHeight():0}getRightHeight(){return this.hasRight()?this.getRight().getHeight():0}updateHeight(){return this._height=Math.max(this.getLeftHeight(),this.getRightHeight())+1,this}getHeight(){return this._height}getBalance(){return this.getLeftHeight()-this.getRightHeight()}isBalanced(){const e=this.getBalance();return e>=-1&&e<=1}}t.AvlTreeNode=n},364:(e,t,r)=>{const{BinarySearchTreeNode:n}=r(105),s=(e,t)=>e===t?0:e>t?1:-1;t.BinarySearchTree=class{constructor(e,t){if(e&&"function"!=typeof e)throw new Error("BinarySearchTree constructor expects a compare function");this._compare=e||s,this._options=t||{},this._root=null,this._count=0}insert(e){const t=new n(e),r=n=>{const s=this._compare(t.getValue(),n.getValue());s<0?n.hasLeft()?r(n.getLeft()):(n.setLeft(t.setParent(n)),this._count+=1):s>0?n.hasRight()?r(n.getRight()):(n.setRight(t.setParent(n)),this._count+=1):n.setValue(e)};return null===this._root?(this._root=t,this._count+=1):r(this._root),this}has(e){const t=r=>{if(null===r)return!1;const n=this._compare(e,r.getValue());return 0===n||t(n<0?r.getLeft():r.getRight())};return t(this._root)}hasKey(e){if(void 0===this._options.key||null===this._options.key)throw new Error("Missing key prop name in constructor options");return this.has({[this._options.key]:e})}find(e){const t=r=>{if(null===r)return null;const n=this._compare(e,r.getValue());return 0===n?r:t(n<0?r.getLeft():r.getRight())};return t(this._root)}findKey(e){if(void 0===this._options.key||null===this._options.key)throw new Error("Missing key prop name in constructor options");return this.find({[this._options.key]:e})}max(e=this._root){return null===e?null:e.hasRight()?this.max(e.getRight()):e}min(e=this._root){return null===e?null:e.hasLeft()?this.min(e.getLeft()):e}lowerBound(e,t=!0){let r=null;const n=s=>{if(null===s)return r;const o=this._compare(e,s.getValue());return o>0||t&&0===o?((null===r||this._compare(r.getValue(),s.getValue())<=0)&&(r=s),n(s.getRight())):n(s.getLeft())};return n(this._root)}lowerBoundKey(e,t=!0){if(void 0===this._options.key||null===this._options.key)throw new Error("Missing key prop name in constructor options");return this.lowerBound({[this._options.key]:e},t)}floor(e,t=!0){return this.lowerBound(e,t)}floorKey(e,t=!0){return this.lowerBoundKey(e,t)}upperBound(e,t=!0){let r=null;const n=s=>{if(null===s)return r;const o=this._compare(e,s.getValue());return o<0||t&&0===o?((null===r||this._compare(r.getValue(),s.getValue())>=0)&&(r=s),n(s.getLeft())):n(s.getRight())};return n(this._root)}upperBoundKey(e,t=!0){if(void 0===this._options.key||null===this._options.key)throw new Error("Missing key prop name in constructor options");return this.upperBound({[this._options.key]:e},t)}ceil(e,t=!0){return this.upperBound(e,t)}ceilKey(e,t=!0){return this.upperBoundKey(e,t)}root(){return this._root}count(){return this._count}remove(e){const t=(e,r)=>{if(null===r)return!1;const n=this._compare(e,r.getValue());return n<0?t(e,r.getLeft()):n>0?t(e,r.getRight()):this.removeNode(r)};return t(e,this._root)}removeNode(e){if(null===e||!(e instanceof n))return!1;if(e.isLeaf())return e.isRoot()?this._root=null:this._compare(e.getValue(),e.getParent().getValue())<0?e.getParent().setLeft(null):e.getParent().setRight(null),this._count-=1,!0;if(!e.hasRight())return e.isRoot()?this._root=e.getLeft():this._compare(e.getValue(),e.getParent().getValue())<0?e.getParent().setLeft(e.getLeft()):e.getParent().setRight(e.getLeft()),e.getLeft().setParent(e.getParent()),this._count-=1,!0;if(!e.hasLeft())return e.isRoot()?this._root=e.getRight():this._compare(e.getValue(),e.getParent().getValue())<0?e.getParent().setLeft(e.getRight()):e.getParent().setRight(e.getRight()),e.getRight().setParent(e.getParent()),this._count-=1,!0;const t=this.min(e.getRight());return e.setValue(t.getValue()),this.removeNode(t)}traverseInOrder(e,t){if("function"!=typeof e)throw new Error(".traverseInOrder expects a callback function");const r=n=>{null===n||t&&t()||(r(n.getLeft()),t&&t()||(e(n),r(n.getRight())))};r(this._root)}traversePreOrder(e,t){if("function"!=typeof e)throw new Error(".traversePreOrder expects a callback function");const r=n=>{null===n||t&&t()||(e(n),r(n.getLeft()),r(n.getRight()))};r(this._root)}traversePostOrder(e,t){if("function"!=typeof e)throw new Error(".traversePostOrder expects a callback function");const r=n=>{null===n||t&&t()||(r(n.getLeft()),r(n.getRight()),t&&t()||e(n))};r(this._root)}clear(){this._root=null,this._count=0}}},105:(e,t)=>{class r{constructor(e){this._value=e,this._left=null,this._right=null,this._parent=null}setValue(e){return this._value=e,this}getValue(){return this._value}setLeft(e){if(e&&!(e instanceof r))throw new Error("setLeft expects a BinarySearchTreeNode");return this._left=e||null,this}getLeft(){return this._left}hasLeft(){return this._left instanceof r}setRight(e){if(e&&!(e instanceof r))throw new Error("setRight expects a BinarySearchTreeNode or null");return this._right=e||null,this}getRight(){return this._right}hasRight(){return this._right instanceof r}setParent(e){if(e&&!(e instanceof r))throw new Error("setParent expects a BinarySearchTreeNode or null");return this._parent=e||null,this}getParent(){return this._parent}hasParent(){return this._parent instanceof r}isRoot(){return null===this._parent}isLeaf(){return!this.hasLeft()&&!this.hasRight()}}t.BinarySearchTreeNode=r},8:(e,t,r)=>{const{Heap:n}=r(138),{MinHeap:s}=r(890),{MaxHeap:o}=r(276);t.H2=s,t.o$=o},138:(e,t)=>{class r{constructor(e,t,r){if("function"!=typeof e)throw new Error("Heap constructor expects a compare function");this._compare=e,this._nodes=Array.isArray(t)?t:[],this._leaf=r||null}toArray(){return Array.from(this._nodes)}_hasLeftChild(e){return 2*e+1<this.size()}_hasRightChild(e){return 2*e+2<this.size()}_compareAt(e,t){return this._compare(this._nodes[e],this._nodes[t])}_swap(e,t){const r=this._nodes[e];this._nodes[e]=this._nodes[t],this._nodes[t]=r}_shouldSwap(e,t){return!(e<0||e>=this.size())&&!(t<0||t>=this.size())&&this._compareAt(e,t)>0}_compareChildrenOf(e){if(!this._hasLeftChild(e)&&!this._hasRightChild(e))return-1;const t=2*e+1,r=2*e+2;return this._hasLeftChild(e)?this._hasRightChild(e)&&this._compareAt(t,r)>0?r:t:r}_compareChildrenBefore(e,t,r){return this._compareAt(r,t)<=0&&r<e?r:t}_heapifyUp(e){let t=e,r=Math.floor((t-1)/2);for(;this._shouldSwap(r,t);)this._swap(r,t),t=r,r=Math.floor((t-1)/2)}_heapifyDown(e){let t=e,r=this._compareChildrenOf(t);for(;this._shouldSwap(t,r);)this._swap(t,r),t=r,r=this._compareChildrenOf(t)}_heapifyDownUntil(e){let t,r=0,n=1,s=2;for(;n<e;)t=this._compareChildrenBefore(e,n,s),this._shouldSwap(r,t)&&this._swap(r,t),r=t,n=2*r+1,s=2*r+2}insert(e){return this._nodes.push(e),this._heapifyUp(this.size()-1),(null===this._leaf||this._compare(e,this._leaf)>0)&&(this._leaf=e),this}push(e){return this.insert(e)}extractRoot(){if(this.isEmpty())return null;const e=this.root();return this._nodes[0]=this._nodes[this.size()-1],this._nodes.pop(),this._heapifyDown(0),e===this._leaf&&(this._leaf=this.root()),e}pop(){return this.extractRoot()}sort(){for(let e=this.size()-1;e>0;e-=1)this._swap(0,e),this._heapifyDownUntil(e);return this._nodes}fix(){for(let e=Math.floor(this.size()/2)-1;e>=0;e-=1)this._heapifyDown(e);for(let e=Math.floor(this.size()/2);e<this.size();e+=1){const t=this._nodes[e];(null===this._leaf||this._compare(t,this._leaf)>0)&&(this._leaf=t)}return this}isValid(){const e=t=>{let r=!0,n=!0;if(this._hasLeftChild(t)){const n=2*t+1;if(this._compareAt(t,n)>0)return!1;r=e(n)}if(this._hasRightChild(t)){const r=2*t+2;if(this._compareAt(t,r)>0)return!1;n=e(r)}return r&&n};return e(0)}clone(){return new r(this._compare,this._nodes.slice(),this._leaf)}root(){return this.isEmpty()?null:this._nodes[0]}top(){return this.root()}leaf(){return this._leaf}size(){return this._nodes.length}isEmpty(){return 0===this.size()}clear(){this._nodes=[],this._leaf=null}[Symbol.iterator](){let e=this.size();return{next:()=>(e-=1,{value:this.pop(),done:-1===e})}}static heapify(e,t){if(!Array.isArray(e))throw new Error("Heap.heapify expects an array of values");if("function"!=typeof t)throw new Error("Heap.heapify expects a compare function");return new r(t,e).fix()}static isHeapified(e,t){return new r(t,e).isValid()}}t.Heap=r},276:(e,t,r)=>{const{Heap:n}=r(138),s=e=>(t,r)=>("function"==typeof e?e(t):t)<("function"==typeof e?e(r):r)?1:-1;class o{constructor(e,t){this._getCompareValue=e,this._heap=t||new n(s(e))}insert(e){return this._heap.insert(e)}push(e){return this.insert(e)}extractRoot(){return this._heap.extractRoot()}pop(){return this.extractRoot()}sort(){return this._heap.sort()}toArray(){return Array.from(this._heap._nodes)}fix(){return this._heap.fix()}isValid(){return this._heap.isValid()}root(){return this._heap.root()}top(){return this.root()}leaf(){return this._heap.leaf()}size(){return this._heap.size()}isEmpty(){return this._heap.isEmpty()}clear(){this._heap.clear()}clone(){return new o(this._getCompareValue,this._heap.clone())}[Symbol.iterator](){let e=this.size();return{next:()=>(e-=1,{value:this.pop(),done:-1===e})}}static heapify(e,t){if(!Array.isArray(e))throw new Error("MaxHeap.heapify expects an array");const r=new n(s(t),e);return new o(t,r).fix()}static isHeapified(e,t){const r=new n(s(t),e);return new o(t,r).isValid()}}t.MaxHeap=o},890:(e,t,r)=>{const{Heap:n}=r(138),s=e=>(t,r)=>("function"==typeof e?e(t):t)<("function"==typeof e?e(r):r)?-1:1;class o{constructor(e,t){this._getCompareValue=e,this._heap=t||new n(s(e))}toArray(){return Array.from(this._heap._nodes)}insert(e){return this._heap.insert(e)}push(e){return this.insert(e)}extractRoot(){return this._heap.extractRoot()}pop(){return this.extractRoot()}sort(){return this._heap.sort()}fix(){return this._heap.fix()}isValid(){return this._heap.isValid()}root(){return this._heap.root()}top(){return this.root()}leaf(){return this._heap.leaf()}size(){return this._heap.size()}isEmpty(){return this._heap.isEmpty()}clear(){this._heap.clear()}clone(){return new o(this._getCompareValue,this._heap.clone())}[Symbol.iterator](){let e=this.size();return{next:()=>(e-=1,{value:this.pop(),done:-1===e})}}static heapify(e,t){if(!Array.isArray(e))throw new Error("MinHeap.heapify expects an array");const r=new n(s(t),e);return new o(t,r).fix()}static isHeapified(e,t){const r=new n(s(t),e);return new o(t,r).isValid()}}t.MinHeap=o},853:(e,t,r)=>{var n,s,o,i,a,l,u,c,f,h,p=r(388),g=r(650),d=(n=g)&&"object"==typeof n&&"default"in n?n.default:n,y=(r(305),r(545),r(644));function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,s,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(s)throw s.error}}return i}function E(e,t,r){if(r||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}(s=t.$M||(t.$M={}))[s.Comparison=0]="Comparison",s[s.Logical=1]="Logical",(o=t.mB||(t.mB={}))[o.Value=0]="Value",o[o.Filter=1]="Filter",o[o.Group=2]="Group",o[o.Column=3]="Column",o[o.Table=4]="Table",(i=t.iv||(t.iv={})).Parenthesis="delimiter.parenthesis.sql",i.Whitespace="white.sql",i.Keyword="keyword.sql",i.Delimiter="delimiter.sql",i.Operator="operator.sql",i.Identifier="identifier.sql",i.IdentifierQuote="identifier.quote.sql",i.Type="type.sql",i.Function="predefined.sql",i.Number="number.sql",i.String="string.sql",i.Variable="variable.sql",(a=t.fC||(t.fC={})).Unknown="unknown",a.SelectKeyword="selectKeyword",a.WithKeyword="withKeyword",a.AfterSelectKeyword="afterSelectKeyword",a.AfterSelectArguments="afterSelectArguments",a.AfterSelectFuncFirstArgument="afterSelectFuncFirstArgument",a.SelectAlias="selectAlias",a.AfterFromKeyword="afterFromKeyword",a.AfterTable="afterTable",a.SchemaFuncFirstArgument="schemaFuncFirstArgument",a.SchemaFuncExtraArgument="schemaFuncExtraArgument",a.FromKeyword="fromKeyword",a.AfterFrom="afterFrom",a.WhereKeyword="whereKeyword",a.WhereComparisonOperator="whereComparisonOperator",a.WhereValue="whereValue",a.AfterWhereFunctionArgument="afterWhereFunctionArgument",a.AfterGroupByFunctionArgument="afterGroupByFunctionArgument",a.AfterWhereValue="afterWhereValue",a.AfterGroupByKeywords="afterGroupByKeywords",a.AfterGroupBy="afterGroupBy",a.AfterOrderByKeywords="afterOrderByKeywords",a.AfterOrderByFunction="afterOrderByFunction",a.AfterOrderByDirection="afterOrderByDirection",a.AfterIsOperator="afterIsOperator",a.AfterIsNotOperator="afterIsNotOperator",a.AfterSchema="afterSchema",(l=t.is||(t.is={})).Schemas="schemas",l.Tables="tables",l.Columns="columns",l.SelectKeyword="selectKeyword",l.WithKeyword="withKeyword",l.FunctionsWithArguments="functionsWithArguments",l.FromKeyword="fromKeyword",l.WhereKeyword="whereKeyword",l.GroupByKeywords="groupByKeywords",l.OrderByKeywords="orderByKeywords",l.FunctionsWithoutArguments="functionsWithoutArguments",l.LimitKeyword="limitKeyword",l.SortOrderDirectionKeyword="sortOrderDirectionKeyword",l.ComparisonOperators="comparisonOperators",l.LogicalOperators="logicalOperators",l.SelectMacro="selectMacro",l.TableMacro="tableMacro",l.FilterMacro="filterMacro",l.GroupMacro="groupMacro",l.BoolValues="boolValues",l.NullValue="nullValue",l.NotKeyword="notKeyword",l.TemplateVariables="templateVariables",l.StarWildCard="starWildCard",(u=t.G8||(t.G8={})).High="a",u.MediumHigh="d",u.Medium="g",u.MediumLow="k",u.Low="q",(c=t.cm||(t.cm={}))[c.Method=0]="Method",c[c.Function=1]="Function",c[c.Constructor=2]="Constructor",c[c.Field=3]="Field",c[c.Variable=4]="Variable",c[c.Class=5]="Class",c[c.Struct=6]="Struct",c[c.Interface=7]="Interface",c[c.Module=8]="Module",c[c.Property=9]="Property",c[c.Event=10]="Event",c[c.Operator=11]="Operator",c[c.Unit=12]="Unit",c[c.Value=13]="Value",c[c.Constant=14]="Constant",c[c.Enum=15]="Enum",c[c.EnumMember=16]="EnumMember",c[c.Keyword=17]="Keyword",c[c.Text=18]="Text",c[c.Color=19]="Color",c[c.File=20]="File",c[c.Reference=21]="Reference",c[c.Customcolor=22]="Customcolor",c[c.Folder=23]="Folder",c[c.TypeParameter=24]="TypeParameter",c[c.User=25]="User",c[c.Issue=26]="Issue",c[c.Snippet=27]="Snippet",(f=t.a7||(t.a7={}))[f.KeepWhitespace=1]="KeepWhitespace",f[f.InsertAsSnippet=4]="InsertAsSnippet",(h=t.je||(t.je={})).Builder="builder",h.Code="code";!function(){function e(e,t,r,n,s){this.type=e,this.value=t,this.range=r,this.previous=n,this.next=s}e.prototype.isKeyword=function(){return this.type===t.iv.Keyword},e.prototype.isWhiteSpace=function(){return this.type===t.iv.Whitespace},e.prototype.isParenthesis=function(){return this.type===t.iv.Parenthesis},e.prototype.isIdentifier=function(){return this.type===t.iv.Identifier},e.prototype.isString=function(){return this.type===t.iv.String},e.prototype.isNumber=function(){return this.type===t.iv.Number},e.prototype.isDoubleQuotedString=function(){return this.type===t.iv.Type},e.prototype.isVariable=function(){return this.type===t.iv.Variable},e.prototype.isFunction=function(){return this.type===t.iv.Function},e.prototype.isOperator=function(){return this.type===t.iv.Operator},e.prototype.isTemplateVariable=function(){return this.type===t.iv.Variable},e.prototype.is=function(e,t){var r=this.type===e;return void 0!==t?r&&q(e,this,t):r},e.prototype.getPreviousNonWhiteSpaceToken=function(){for(var e=this.previous;null!=e;){if(!e.isWhiteSpace())return e;e=e.previous}return null},e.prototype.getPreviousOfType=function(e,t){for(var r=this.previous;null!=r;){var n=r.type===e;if(void 0!==t?n&&q(e,r,t):n)return r;r=r.previous}return null},e.prototype.getPreviousUntil=function(e,t,r){for(var n=[],s=this.previous;null!=s;)if(t.some((function(e){return e===(null==s?void 0:s.type)})))s=s.previous;else{var o=s.type===e;if(void 0!==r?o&&q(e,s,r):o)return n;s.isWhiteSpace()||n.push(s),s=s.previous}return n},e.prototype.getNextUntil=function(e,t,r){for(var n=[],s=this.next;null!=s;)if(t.some((function(e){return e===(null==s?void 0:s.type)})))s=s.next;else{var o=s.type===e;if(void 0!==r?o&&q(e,s,r):o)return n;s.isWhiteSpace()||n.push(s),s=s.next}return n},e.prototype.getPreviousKeyword=function(){for(var e=this.previous;null!=e;){if(e.isKeyword())return e;e=e.previous}return null},e.prototype.getNextNonWhiteSpaceToken=function(){for(var e=this.next;null!=e;){if(!e.isWhiteSpace())return e;e=e.next}return null},e.prototype.getNextOfType=function(e,t){for(var r=this.next;null!=r;){var n=r.type===e;if(void 0!==t?n&&q(e,r,t):n)return r;r=r.next}return null}}();function q(e,r,n){return e===t.iv.Keyword||e===t.iv.Operator?r.value.toLowerCase()===n.toString().toLowerCase():r.value===n}var v="select",w="from",T="by",R="desc",_="asc",A=["=","!="],O=E([],m(A),!1);Object.freeze({__proto__:null,SELECT:v,FROM:w,WHERE:"where",GROUP:"group",ORDER:"order",BY:T,DESC:R,ASC:_,LIMIT:"limit",WITH:"with",AS:"as",SCHEMA:"schema",AND:"AND",OR:"OR",LOGICAL_OPERATORS:["AND","OR"],EQUALS:"=",NOT_EQUALS:"!=",COMPARISON_OPERATORS:A,STD_OPERATORS:O,conf:{comments:{lineComment:"--",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]},language:{defaultToken:"",tokenPostfix:".sql",ignoreCase:!0,brackets:[{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"}],keywords:["ABORT","ABSOLUTE","ACTION","ADA","ADD","AFTER","ALL","ALLOCATE","ALTER","ALWAYS","ANALYZE","AND","ANY","ARE","AS","ASC","ASSERTION","AT","ATTACH","AUTHORIZATION","AUTOINCREMENT","AVG","BACKUP","BEFORE","BEGIN","BETWEEN","BIT","BIT_LENGTH","BOTH","BREAK","BROWSE","BULK","BY","CASCADE","CASCADED","CASE","CAST","CATALOG","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","CHECK","CHECKPOINT","CLOSE","CLUSTERED","COALESCE","COLLATE","COLLATION","COLUMN","COMMIT","COMPUTE","CONFLICT","CONNECT","CONNECTION","CONSTRAINT","CONSTRAINTS","CONTAINS","CONTAINSTABLE","CONTINUE","CONVERT","CORRESPONDING","COUNT","CREATE","CROSS","CURRENT","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATE","DAY","DBCC","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DENY","DESC","DESCRIBE","DESCRIPTOR","DETACH","DIAGNOSTICS","DISCONNECT","DISK","DISTINCT","DISTRIBUTED","DO","DOMAIN","DOUBLE","DROP","DUMP","EACH","ELSE","END","END-EXEC","ERRLVL","ESCAPE","EXCEPT","EXCEPTION","EXCLUDE","EXCLUSIVE","EXEC","EXECUTE","EXISTS","EXIT","EXPLAIN","EXTERNAL","EXTRACT","FAIL","FALSE","FETCH","FILE","FILLFACTOR","FILTER","FIRST","FLOAT","FOLLOWING","FOR","FOREIGN","FORTRAN","FOUND","FREETEXT","FREETEXTTABLE","FROM","FULL","FUNCTION","GENERATED","GET","GLOB","GLOBAL","GO","GOTO","GRANT","GROUP","GROUPS","HAVING","HOLDLOCK","HOUR","IDENTITY","IDENTITYCOL","IDENTITY_INSERT","IF","IGNORE","IMMEDIATE","IN","INCLUDE","INDEX","INDEXED","INDICATOR","INITIALLY","INNER","INPUT","INSENSITIVE","INSERT","INSTEAD","INT","INTEGER","INTERSECT","INTERVAL","INTO","IS","ISNULL","ISOLATION","JOIN","KEY","KILL","LANGUAGE","LAST","LEADING","LEFT","LEVEL","LIKE","LIMIT","LINENO","LOAD","LOCAL","LOWER","MATCH","MATERIALIZED","MAX","MERGE","MIN","MINUTE","MODULE","MONTH","NAMES","NATIONAL","NATURAL","NCHAR","NEXT","NO","NOCHECK","NONCLUSTERED","NONE","NOT","NOTHING","NOTNULL","NULL","NULLIF","NULLS","NUMERIC","OCTET_LENGTH","OF","OFF","OFFSET","OFFSETS","ON","ONLY","OPEN","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","OPTION","OR","ORDER","OTHERS","OUTER","OUTPUT","OVER","OVERLAPS","PAD","PARTIAL","PARTITION","PASCAL","PERCENT","PIVOT","PLAN","POSITION","PRAGMA","PRECEDING","PRECISION","PREPARE","PRESERVE","PRIMARY","PRINT","PRIOR","PRIVILEGES","PROC","PROCEDURE","PUBLIC","QUERY","RAISE","RAISERROR","RANGE","READ","READTEXT","REAL","RECONFIGURE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELATIVE","RELEASE","RENAME","REPLACE","REPLICATION","RESTORE","RESTRICT","RETURN","RETURNING","REVERT","REVOKE","RIGHT","ROLLBACK","ROW","ROWCOUNT","ROWGUIDCOL","ROWS","RULE","SAVE","SAVEPOINT","SCHEMA","SCROLL","SECOND","SECTION","SECURITYAUDIT","SELECT","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","SESSION","SESSION_USER","SET","SETUSER","SHUTDOWN","SIZE","SMALLINT","SOME","SPACE","SQL","SQLCA","SQLCODE","SQLERROR","SQLSTATE","SQLWARNING","STATISTICS","SUBSTRING","SUM","SYSTEM_USER","TABLE","TABLESAMPLE","TEMP","TEMPORARY","TEXTSIZE","THEN","TIES","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TOP","TRAILING","TRAN","TRANSACTION","TRANSLATE","TRANSLATION","TRIGGER","TRIM","TRUE","TRUNCATE","TRY_CONVERT","TSEQUAL","UNBOUNDED","UNION","UNIQUE","UNKNOWN","UNPIVOT","UPDATE","UPDATETEXT","UPPER","USAGE","USE","USER","USING","VACUUM","VALUE","VALUES","VARCHAR","VARYING","VIEW","VIRTUAL","WAITFOR","WHEN","WHENEVER","WHERE","WHILE","WINDOW","WITH","WITHIN GROUP","WITHOUT","WORK","WRITE","WRITETEXT","YEAR","ZONE"],operators:["EXCEPT","INTERSECT","UNION","APPLY","CROSS","FULL","INNER","JOIN","LEFT","OUTER","RIGHT","CONTAINS","FREETEXT","IS","NULL","PIVOT","UNPIVOT","MATCHED"],logicalOperators:["ALL","AND","ANY","BETWEEN","EXISTS","IN","LIKE","NOT","OR","SOME"],comparisonOperators:["<>",">","<",">=","<=","=","!=","&","~","^","%"],builtinFunctions:["AVG","CHECKSUM_AGG","COUNT","COUNT_BIG","GROUPING","GROUPING_ID","MAX","MIN","SUM","STDEV","STDEVP","VAR","VARP","CUME_DIST","FIRST_VALUE","LAG","LAST_VALUE","LEAD","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","COLLATE","COLLATIONPROPERTY","TERTIARY_WEIGHTS","FEDERATION_FILTERING_VALUE","CAST","CONVERT","PARSE","TRY_CAST","TRY_CONVERT","TRY_PARSE","ASYMKEY_ID","ASYMKEYPROPERTY","CERTPROPERTY","CERT_ID","CRYPT_GEN_RANDOM","DECRYPTBYASYMKEY","DECRYPTBYCERT","DECRYPTBYKEY","DECRYPTBYKEYAUTOASYMKEY","DECRYPTBYKEYAUTOCERT","DECRYPTBYPASSPHRASE","ENCRYPTBYASYMKEY","ENCRYPTBYCERT","ENCRYPTBYKEY","ENCRYPTBYPASSPHRASE","HASHBYTES","IS_OBJECTSIGNED","KEY_GUID","KEY_ID","KEY_NAME","SIGNBYASYMKEY","SIGNBYCERT","SYMKEYPROPERTY","VERIFYSIGNEDBYCERT","VERIFYSIGNEDBYASYMKEY","CURSOR_STATUS","DATALENGTH","IDENT_CURRENT","IDENT_INCR","IDENT_SEED","IDENTITY","SQL_VARIANT_PROPERTY","CURRENT_TIMESTAMP","DATEADD","DATEDIFF","DATEFROMPARTS","DATENAME","DATEPART","DATETIME2FROMPARTS","DATETIMEFROMPARTS","DATETIMEOFFSETFROMPARTS","DAY","EOMONTH","GETDATE","GETUTCDATE","ISDATE","MONTH","SMALLDATETIMEFROMPARTS","SWITCHOFFSET","SYSDATETIME","SYSDATETIMEOFFSET","SYSUTCDATETIME","TIMEFROMPARTS","TODATETIMEOFFSET","YEAR","CHOOSE","COALESCE","IIF","NULLIF","ABS","ACOS","ASIN","ATAN","ATN2","CEILING","COS","COT","DEGREES","EXP","FLOOR","LOG","LOG10","PI","POWER","RADIANS","RAND","ROUND","SIGN","SIN","SQRT","SQUARE","TAN","APP_NAME","APPLOCK_MODE","APPLOCK_TEST","ASSEMBLYPROPERTY","COL_LENGTH","COL_NAME","COLUMNPROPERTY","DATABASE_PRINCIPAL_ID","DATABASEPROPERTYEX","DB_ID","DB_NAME","FILE_ID","FILE_IDEX","FILE_NAME","FILEGROUP_ID","FILEGROUP_NAME","FILEGROUPPROPERTY","FILEPROPERTY","FULLTEXTCATALOGPROPERTY","FULLTEXTSERVICEPROPERTY","INDEX_COL","INDEXKEY_PROPERTY","INDEXPROPERTY","OBJECT_DEFINITION","OBJECT_ID","OBJECT_NAME","OBJECT_SCHEMA_NAME","OBJECTPROPERTY","OBJECTPROPERTYEX","ORIGINAL_DB_NAME","PARSENAME","SCHEMA_ID","SCHEMA_NAME","SCOPE_IDENTITY","SERVERPROPERTY","STATS_DATE","TYPE_ID","TYPE_NAME","TYPEPROPERTY","DENSE_RANK","NTILE","RANK","ROW_NUMBER","PUBLISHINGSERVERNAME","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","CERTENCODED","CERTPRIVATEKEY","CURRENT_USER","HAS_DBACCESS","HAS_PERMS_BY_NAME","IS_MEMBER","IS_ROLEMEMBER","IS_SRVROLEMEMBER","LOGINPROPERTY","ORIGINAL_LOGIN","PERMISSIONS","PWDENCRYPT","PWDCOMPARE","SESSION_USER","SESSIONPROPERTY","SUSER_ID","SUSER_NAME","SUSER_SID","SUSER_SNAME","SYSTEM_USER","USER","USER_ID","USER_NAME","ASCII","CHAR","CHARINDEX","CONCAT","DIFFERENCE","FORMAT","LEFT","LEN","LOWER","LTRIM","NCHAR","PATINDEX","QUOTENAME","REPLACE","REPLICATE","REVERSE","RIGHT","RTRIM","SOUNDEX","SPACE","STR","STUFF","SUBSTRING","UNICODE","UPPER","BINARY_CHECKSUM","CHECKSUM","CONNECTIONPROPERTY","CONTEXT_INFO","CURRENT_REQUEST_ID","ERROR_LINE","ERROR_NUMBER","ERROR_MESSAGE","ERROR_PROCEDURE","ERROR_SEVERITY","ERROR_STATE","FORMATMESSAGE","GETANSINULL","GET_FILESTREAM_TRANSACTION_CONTEXT","HOST_ID","HOST_NAME","ISNULL","ISNUMERIC","MIN_ACTIVE_ROWVERSION","NEWID","NEWSEQUENTIALID","ROWCOUNT_BIG","XACT_STATE","TEXTPTR","TEXTVALID","COLUMNS_UPDATED","EVENTDATA","TRIGGER_NESTLEVEL","UPDATE","CHANGETABLE","CHANGE_TRACKING_CONTEXT","CHANGE_TRACKING_CURRENT_VERSION","CHANGE_TRACKING_IS_COLUMN_IN_MASK","CHANGE_TRACKING_MIN_VALID_VERSION","CONTAINSTABLE","FREETEXTTABLE","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","FILETABLEROOTPATH","GETFILENAMESPACEPATH","GETPATHLOCATOR","PATHNAME","GET_TRANSMISSION_STATUS"],builtinVariables:["@@DATEFIRST","@@DBTS","@@LANGID","@@LANGUAGE","@@LOCK_TIMEOUT","@@MAX_CONNECTIONS","@@MAX_PRECISION","@@NESTLEVEL","@@OPTIONS","@@REMSERVER","@@SERVERNAME","@@SERVICENAME","@@SPID","@@TEXTSIZE","@@VERSION","@@CURSOR_ROWS","@@FETCH_STATUS","@@DATEFIRST","@@PROCID","@@ERROR","@@IDENTITY","@@ROWCOUNT","@@TRANCOUNT","@@CONNECTIONS","@@CPU_BUSY","@@IDLE","@@IO_BUSY","@@PACKET_ERRORS","@@PACK_RECEIVED","@@PACK_SENT","@@TIMETICKS","@@TOTAL_ERRORS","@@TOTAL_READ","@@TOTAL_WRITE"],pseudoColumns:["$ACTION","$IDENTITY","$ROWGUID","$PARTITION"],tokenizer:{root:[{include:"@templateVariables"},{include:"@macros"},{include:"@comments"},{include:"@whitespace"},{include:"@pseudoColumns"},{include:"@numbers"},{include:"@strings"},{include:"@complexIdentifiers"},{include:"@scopes"},{include:"@schemaTable"},[/[;,.]/,"delimiter"],[/[()]/,"@brackets"],[/[\w@#$|<|>|=|!|%|&|+|\|-|*|/|~|^]+/,{cases:{"@operators":"operator","@comparisonOperators":"operator","@logicalOperators":"operator","@builtinVariables":"predefined","@builtinFunctions":"predefined","@keywords":"keyword","@default":"identifier"}}]],templateVariables:[[/\$[a-zA-Z0-9]+/,"variable"]],macros:[[/\$__[a-zA-Z0-9-_]+/,"type"]],schemaTable:[[/(\w+)\./,"identifier"],[/(\w+\.\w+)/,"identifier"]],whitespace:[[/\s+/,"white"]],comments:[[/--+.*/,"comment"],[/\/\*/,{token:"comment.quote",next:"@comment"}]],comment:[[/[^*/]+/,"comment"],[/\*\//,{token:"comment.quote",next:"@pop"}],[/./,"comment"]],pseudoColumns:[[/[$][A-Za-z_][\w@#$]*/,{cases:{"@pseudoColumns":"predefined","@default":"identifier"}}]],numbers:[[/0[xX][0-9a-fA-F]*/,"number"],[/[$][+-]*\d*(\.\d*)?/,"number"],[/((\d+(\.\d*)?)|(\.\d+))([eE][\-+]?\d+)?/,"number"]],strings:[[/N'/,{token:"string",next:"@string"}],[/'/,{token:"string",next:"@string"}]],string:[[/[^']+/,"string"],[/''/,"string"],[/'/,{token:"string",next:"@pop"}]],complexIdentifiers:[[/\[/,{token:"identifier.quote",next:"@bracketedIdentifier"}],[/"/,{token:"identifier.quote",next:"@quotedIdentifier"}]],bracketedIdentifier:[[/[^\]]+/,"identifier"],[/]]/,"identifier"],[/]/,{token:"identifier.quote",next:"@pop"}]],quotedIdentifier:[[/[^"]+/,"identifier"],[/""/,"identifier"],[/"/,{token:"identifier.quote",next:"@pop"}]],scopes:[[/BEGIN\s+(DISTRIBUTED\s+)?TRAN(SACTION)?\b/i,"keyword"],[/BEGIN\s+TRY\b/i,{token:"keyword.try"}],[/END\s+TRY\b/i,{token:"keyword.try"}],[/BEGIN\s+CATCH\b/i,{token:"keyword.catch"}],[/END\s+CATCH\b/i,{token:"keyword.catch"}],[/(BEGIN|CASE)\b/i,{token:"keyword.block"}],[/END\b/i,{token:"keyword.block"}],[/WHEN\b/i,{token:"keyword.choice"}],[/THEN\b/i,{token:"keyword.choice"}]]}}}),new Uint8Array(16);for(var S=[],b=0;b<256;++b)S.push((b+256).toString(16).substr(1));var N={logger:function(){}};p.attachDebugger&&p.createLogger&&(N=p.createLogger("SQLEditor"),N.logger,p.attachDebugger("sqleditor",void 0,N));t.mB.Filter,t.mB.Filter,t.mB.Filter,t.mB.Value,t.mB.Table,t.mB.Column;new Map,new Map,Object.freeze({__proto__:null,singleLineFullQuery:{query:'SELECT column1, FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"keyword.sql",language:"sql"},{offset:20,type:"white.sql",language:"sql"},{offset:21,type:"identifier.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"keyword.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"identifier.sql",language:"sql"},{offset:41,type:"white.sql",language:"sql"},{offset:42,type:"operator.sql",language:"sql"},{offset:43,type:"white.sql",language:"sql"},{offset:44,type:"identifier.quote.sql",language:"sql"},{offset:45,type:"identifier.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"},{offset:53,type:"keyword.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"keyword.sql",language:"sql"},{offset:61,type:"white.sql",language:"sql"},{offset:62,type:"identifier.sql",language:"sql"},{offset:69,type:"white.sql",language:"sql"},{offset:70,type:"keyword.sql",language:"sql"},{offset:75,type:"white.sql",language:"sql"},{offset:76,type:"keyword.sql",language:"sql"},{offset:78,type:"white.sql",language:"sql"},{offset:79,type:"identifier.sql",language:"sql"},{offset:86,type:"white.sql",language:"sql"},{offset:87,type:"keyword.sql",language:"sql"},{offset:91,type:"white.sql",language:"sql"},{offset:92,type:"keyword.sql",language:"sql"},{offset:97,type:"white.sql",language:"sql"},{offset:98,type:"number.sql",language:"sql"},{offset:100,type:"delimiter.sql",language:"sql"}]]},singleLineFullQueryWithAggregation:{query:'SELECT count(column1), FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"identifier.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"keyword.sql",language:"sql"},{offset:40,type:"white.sql",language:"sql"},{offset:41,type:"identifier.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"operator.sql",language:"sql"},{offset:50,type:"white.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"identifier.sql",language:"sql"},{offset:58,type:"identifier.quote.sql",language:"sql"},{offset:59,type:"white.sql",language:"sql"},{offset:60,type:"keyword.sql",language:"sql"},{offset:65,type:"white.sql",language:"sql"},{offset:66,type:"keyword.sql",language:"sql"},{offset:68,type:"white.sql",language:"sql"},{offset:69,type:"identifier.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"keyword.sql",language:"sql"},{offset:82,type:"white.sql",language:"sql"},{offset:83,type:"keyword.sql",language:"sql"},{offset:85,type:"white.sql",language:"sql"},{offset:86,type:"identifier.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"keyword.sql",language:"sql"},{offset:98,type:"white.sql",language:"sql"},{offset:99,type:"keyword.sql",language:"sql"},{offset:104,type:"white.sql",language:"sql"},{offset:105,type:"number.sql",language:"sql"},{offset:107,type:"delimiter.sql",language:"sql"}]]},multiLineFullQuery:{query:'SELECT column1,  \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1 DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"keyword.sql",language:"sql"},{offset:38,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]},multiLineFullQueryWithAggregation:{query:'SELECT count(column1),  \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1 DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"keyword.sql",language:"sql"},{offset:38,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]},singleLineEmptyQuery:{query:"",tokens:[]},singleLineTwoQueries:{query:'SELECT column1, FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10; SELECT column2, FROM table2 WHERE column2 = "value2" GROUP BY column1 ORDER BY column2 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"keyword.sql",language:"sql"},{offset:20,type:"white.sql",language:"sql"},{offset:21,type:"identifier.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"keyword.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"identifier.sql",language:"sql"},{offset:41,type:"white.sql",language:"sql"},{offset:42,type:"operator.sql",language:"sql"},{offset:43,type:"white.sql",language:"sql"},{offset:44,type:"identifier.quote.sql",language:"sql"},{offset:45,type:"identifier.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"},{offset:53,type:"keyword.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"keyword.sql",language:"sql"},{offset:61,type:"white.sql",language:"sql"},{offset:62,type:"identifier.sql",language:"sql"},{offset:69,type:"white.sql",language:"sql"},{offset:70,type:"keyword.sql",language:"sql"},{offset:75,type:"white.sql",language:"sql"},{offset:76,type:"keyword.sql",language:"sql"},{offset:78,type:"white.sql",language:"sql"},{offset:79,type:"identifier.sql",language:"sql"},{offset:86,type:"white.sql",language:"sql"},{offset:87,type:"keyword.sql",language:"sql"},{offset:91,type:"white.sql",language:"sql"},{offset:92,type:"keyword.sql",language:"sql"},{offset:97,type:"white.sql",language:"sql"},{offset:98,type:"number.sql",language:"sql"},{offset:100,type:"delimiter.sql",language:"sql"},{offset:101,type:"white.sql",language:"sql"},{offset:102,type:"keyword.sql",language:"sql"},{offset:108,type:"white.sql",language:"sql"},{offset:109,type:"identifier.sql",language:"sql"},{offset:116,type:"delimiter.sql",language:"sql"},{offset:117,type:"white.sql",language:"sql"},{offset:118,type:"keyword.sql",language:"sql"},{offset:122,type:"white.sql",language:"sql"},{offset:123,type:"identifier.sql",language:"sql"},{offset:129,type:"white.sql",language:"sql"},{offset:130,type:"keyword.sql",language:"sql"},{offset:135,type:"white.sql",language:"sql"},{offset:136,type:"identifier.sql",language:"sql"},{offset:143,type:"white.sql",language:"sql"},{offset:144,type:"operator.sql",language:"sql"},{offset:145,type:"white.sql",language:"sql"},{offset:146,type:"identifier.quote.sql",language:"sql"},{offset:147,type:"identifier.sql",language:"sql"},{offset:153,type:"identifier.quote.sql",language:"sql"},{offset:154,type:"white.sql",language:"sql"},{offset:155,type:"keyword.sql",language:"sql"},{offset:160,type:"white.sql",language:"sql"},{offset:161,type:"keyword.sql",language:"sql"},{offset:163,type:"white.sql",language:"sql"},{offset:164,type:"identifier.sql",language:"sql"},{offset:171,type:"white.sql",language:"sql"},{offset:172,type:"keyword.sql",language:"sql"},{offset:177,type:"white.sql",language:"sql"},{offset:178,type:"keyword.sql",language:"sql"},{offset:180,type:"white.sql",language:"sql"},{offset:181,type:"identifier.sql",language:"sql"},{offset:188,type:"white.sql",language:"sql"},{offset:189,type:"keyword.sql",language:"sql"},{offset:193,type:"white.sql",language:"sql"},{offset:194,type:"keyword.sql",language:"sql"},{offset:199,type:"white.sql",language:"sql"},{offset:200,type:"number.sql",language:"sql"},{offset:202,type:"delimiter.sql",language:"sql"}]]},singleLineTwoQueriesWithAggregation:{query:'SELECT count(column1), FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10; SELECT count(column2), FROM table2 WHERE column2 = "value2" GROUP BY column1 ORDER BY column2 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"identifier.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"keyword.sql",language:"sql"},{offset:40,type:"white.sql",language:"sql"},{offset:41,type:"identifier.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"operator.sql",language:"sql"},{offset:50,type:"white.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"identifier.sql",language:"sql"},{offset:58,type:"identifier.quote.sql",language:"sql"},{offset:59,type:"white.sql",language:"sql"},{offset:60,type:"keyword.sql",language:"sql"},{offset:65,type:"white.sql",language:"sql"},{offset:66,type:"keyword.sql",language:"sql"},{offset:68,type:"white.sql",language:"sql"},{offset:69,type:"identifier.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"keyword.sql",language:"sql"},{offset:82,type:"white.sql",language:"sql"},{offset:83,type:"keyword.sql",language:"sql"},{offset:85,type:"white.sql",language:"sql"},{offset:86,type:"identifier.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"keyword.sql",language:"sql"},{offset:98,type:"white.sql",language:"sql"},{offset:99,type:"keyword.sql",language:"sql"},{offset:104,type:"white.sql",language:"sql"},{offset:105,type:"number.sql",language:"sql"},{offset:107,type:"delimiter.sql",language:"sql"},{offset:108,type:"white.sql",language:"sql"},{offset:109,type:"keyword.sql",language:"sql"},{offset:115,type:"white.sql",language:"sql"},{offset:116,type:"predefined.sql",language:"sql"},{offset:121,type:"delimiter.parenthesis.sql",language:"sql"},{offset:122,type:"identifier.sql",language:"sql"},{offset:129,type:"delimiter.parenthesis.sql",language:"sql"},{offset:130,type:"delimiter.sql",language:"sql"},{offset:131,type:"white.sql",language:"sql"},{offset:132,type:"keyword.sql",language:"sql"},{offset:136,type:"white.sql",language:"sql"},{offset:137,type:"identifier.sql",language:"sql"},{offset:143,type:"white.sql",language:"sql"},{offset:144,type:"keyword.sql",language:"sql"},{offset:149,type:"white.sql",language:"sql"},{offset:150,type:"identifier.sql",language:"sql"},{offset:157,type:"white.sql",language:"sql"},{offset:158,type:"operator.sql",language:"sql"},{offset:159,type:"white.sql",language:"sql"},{offset:160,type:"identifier.quote.sql",language:"sql"},{offset:161,type:"identifier.sql",language:"sql"},{offset:167,type:"identifier.quote.sql",language:"sql"},{offset:168,type:"white.sql",language:"sql"},{offset:169,type:"keyword.sql",language:"sql"},{offset:174,type:"white.sql",language:"sql"},{offset:175,type:"keyword.sql",language:"sql"},{offset:177,type:"white.sql",language:"sql"},{offset:178,type:"identifier.sql",language:"sql"},{offset:185,type:"white.sql",language:"sql"},{offset:186,type:"keyword.sql",language:"sql"},{offset:191,type:"white.sql",language:"sql"},{offset:192,type:"keyword.sql",language:"sql"},{offset:194,type:"white.sql",language:"sql"},{offset:195,type:"identifier.sql",language:"sql"},{offset:202,type:"white.sql",language:"sql"},{offset:203,type:"keyword.sql",language:"sql"},{offset:207,type:"white.sql",language:"sql"},{offset:208,type:"keyword.sql",language:"sql"},{offset:213,type:"white.sql",language:"sql"},{offset:214,type:"number.sql",language:"sql"},{offset:216,type:"delimiter.sql",language:"sql"}]]},singleLineMultipleColumns:{query:'SELECT count(column1), column2 FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1, avg(column2) DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"identifier.sql",language:"sql"},{offset:30,type:"white.sql",language:"sql"},{offset:31,type:"keyword.sql",language:"sql"},{offset:35,type:"white.sql",language:"sql"},{offset:36,type:"identifier.sql",language:"sql"},{offset:42,type:"white.sql",language:"sql"},{offset:43,type:"keyword.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"identifier.sql",language:"sql"},{offset:56,type:"white.sql",language:"sql"},{offset:57,type:"operator.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"identifier.quote.sql",language:"sql"},{offset:60,type:"identifier.sql",language:"sql"},{offset:66,type:"identifier.quote.sql",language:"sql"},{offset:67,type:"white.sql",language:"sql"},{offset:68,type:"keyword.sql",language:"sql"},{offset:73,type:"white.sql",language:"sql"},{offset:74,type:"keyword.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"identifier.sql",language:"sql"},{offset:84,type:"white.sql",language:"sql"},{offset:85,type:"keyword.sql",language:"sql"},{offset:90,type:"white.sql",language:"sql"},{offset:91,type:"keyword.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"identifier.sql",language:"sql"},{offset:101,type:"delimiter.sql",language:"sql"},{offset:102,type:"white.sql",language:"sql"},{offset:103,type:"predefined.sql",language:"sql"},{offset:106,type:"delimiter.parenthesis.sql",language:"sql"},{offset:107,type:"identifier.sql",language:"sql"},{offset:114,type:"delimiter.parenthesis.sql",language:"sql"},{offset:115,type:"white.sql",language:"sql"},{offset:116,type:"keyword.sql",language:"sql"},{offset:120,type:"white.sql",language:"sql"},{offset:121,type:"keyword.sql",language:"sql"},{offset:126,type:"white.sql",language:"sql"},{offset:127,type:"number.sql",language:"sql"},{offset:129,type:"delimiter.sql",language:"sql"}]]},multiLineMultipleColumns:{query:'SELECT count(column1), column2 \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1, avg(column2) DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"identifier.sql",language:"sql"},{offset:30,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"delimiter.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"predefined.sql",language:"sql"},{offset:38,type:"delimiter.parenthesis.sql",language:"sql"},{offset:39,type:"identifier.sql",language:"sql"},{offset:46,type:"delimiter.parenthesis.sql",language:"sql"},{offset:47,type:"white.sql",language:"sql"},{offset:48,type:"keyword.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]}});var C=function(e){var t=e.children,r=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r}(e,["children"]),n=p.useStyles2(g.useCallback((function(e){return I(e,r)}),[r]));return d.createElement("div",{className:n.root},t)},I=function(e,t){var r,n,s;return{root:y.css({display:"flex",flexDirection:null!==(r=t.direction)&&void 0!==r?r:"row",flexWrap:null===(n=t.wrap)||void 0===n||n?"wrap":void 0,alignItems:t.alignItems,gap:e.spacing(null!==(s=t.gap)&&void 0!==s?s:2),flexGrow:t.flexGrow})}},P=function(e){return{root:y.css({padding:e.spacing(1),backgroundColor:e.colors.background.secondary,borderRadius:e.shape.borderRadius(1)})}};d.forwardRef((function(e,t){var r=e.items,n=e.renderItem,s=e.onChange;return d.createElement(C,null,r.map((function(e,t){return d.createElement("div",{key:t},n(e,(function(e){return function(e,t){var n=E([],m(r),!1);n[e]=t,s(n)}(t,e)}),(function(){return e=t,(n=E([],m(r),!1)).splice(e,1),void s(n);var e,n})))})),d.createElement(p.Button,{ref:t,onClick:function(){var e=E(E([],m(r),!1),[{}],!1);s(e)},variant:"secondary",size:"md",icon:"plus","aria-label":"Add",type:"button"}))}));t.EditorRow=function(e){var t=e.children,r=p.useStyles2(P);return d.createElement("div",{className:r.root},d.createElement(C,{gap:2},t))},t.EditorRows=function(e){var t=e.children;return d.createElement(C,{gap:.5,direction:"column"},t)}},988:(e,t,r)=>{"use strict";e.exports=r(853)},646:(e,t,r)=>{e.exports={RBTree:r(647),BinTree:r(962)}},962:(e,t,r)=>{var n=r(318);function s(e){this.data=e,this.left=null,this.right=null}function o(e){this._root=null,this._comparator=e,this.size=0}s.prototype.get_child=function(e){return e?this.right:this.left},s.prototype.set_child=function(e,t){e?this.right=t:this.left=t},o.prototype=new n,o.prototype.insert=function(e){if(null===this._root)return this._root=new s(e),this.size++,!0;for(var t=0,r=null,n=this._root;;){if(null===n)return n=new s(e),r.set_child(t,n),ret=!0,this.size++,!0;if(0===this._comparator(n.data,e))return!1;t=this._comparator(n.data,e)<0,r=n,n=n.get_child(t)}},o.prototype.remove=function(e){if(null===this._root)return!1;var t=new s(void 0),r=t;r.right=this._root;for(var n=null,o=null,i=1;null!==r.get_child(i);){n=r,r=r.get_child(i);var a=this._comparator(e,r.data);i=a>0,0===a&&(o=r)}return null!==o&&(o.data=r.data,n.set_child(n.right===r,r.get_child(null===r.left)),this._root=t.right,this.size--,!0)},e.exports=o},647:(e,t,r)=>{var n=r(318);function s(e){this.data=e,this.left=null,this.right=null,this.red=!0}function o(e){this._root=null,this._comparator=e,this.size=0}function i(e){return null!==e&&e.red}function a(e,t){var r=e.get_child(!t);return e.set_child(!t,r.get_child(t)),r.set_child(t,e),e.red=!0,r.red=!1,r}function l(e,t){return e.set_child(!t,a(e.get_child(!t),!t)),a(e,t)}s.prototype.get_child=function(e){return e?this.right:this.left},s.prototype.set_child=function(e,t){e?this.right=t:this.left=t},o.prototype=new n,o.prototype.insert=function(e){var t=!1;if(null===this._root)this._root=new s(e),t=!0,this.size++;else{var r=new s(void 0),n=0,o=0,u=null,c=r,f=null,h=this._root;for(c.right=this._root;;){if(null===h?(h=new s(e),f.set_child(n,h),t=!0,this.size++):i(h.left)&&i(h.right)&&(h.red=!0,h.left.red=!1,h.right.red=!1),i(h)&&i(f)){var p=c.right===u;h===f.get_child(o)?c.set_child(p,a(u,!o)):c.set_child(p,l(u,!o))}var g=this._comparator(h.data,e);if(0===g)break;o=n,n=g<0,null!==u&&(c=u),u=f,f=h,h=h.get_child(n)}this._root=r.right}return this._root.red=!1,t},o.prototype.remove=function(e){if(null===this._root)return!1;var t=new s(void 0),r=t;r.right=this._root;for(var n=null,o=null,u=null,c=1;null!==r.get_child(c);){var f=c;o=n,n=r,r=r.get_child(c);var h=this._comparator(e,r.data);if(c=h>0,0===h&&(u=r),!i(r)&&!i(r.get_child(c)))if(i(r.get_child(!c))){var p=a(r,c);n.set_child(f,p),n=p}else if(!i(r.get_child(!c))){var g=n.get_child(!f);if(null!==g)if(i(g.get_child(!f))||i(g.get_child(f))){var d=o.right===n;i(g.get_child(f))?o.set_child(d,l(n,f)):i(g.get_child(!f))&&o.set_child(d,a(n,f));var y=o.get_child(d);y.red=!0,r.red=!0,y.left.red=!1,y.right.red=!1}else n.red=!1,g.red=!0,r.red=!0}}return null!==u&&(u.data=r.data,n.set_child(n.right===r,r.get_child(null===r.left)),this.size--),this._root=t.right,null!==this._root&&(this._root.red=!1),null!==u},e.exports=o},318:e=>{function t(){}function r(e){this._tree=e,this._ancestors=[],this._cursor=null}t.prototype.clear=function(){this._root=null,this.size=0},t.prototype.find=function(e){for(var t=this._root;null!==t;){var r=this._comparator(e,t.data);if(0===r)return t.data;t=t.get_child(r>0)}return null},t.prototype.findIter=function(e){for(var t=this._root,r=this.iterator();null!==t;){var n=this._comparator(e,t.data);if(0===n)return r._cursor=t,r;r._ancestors.push(t),t=t.get_child(n>0)}return null},t.prototype.lowerBound=function(e){for(var t=this._root,r=this.iterator(),n=this._comparator;null!==t;){var s=n(e,t.data);if(0===s)return r._cursor=t,r;r._ancestors.push(t),t=t.get_child(s>0)}for(var o=r._ancestors.length-1;o>=0;--o)if(n(e,(t=r._ancestors[o]).data)<0)return r._cursor=t,r._ancestors.length=o,r;return r._ancestors.length=0,r},t.prototype.upperBound=function(e){for(var t=this.lowerBound(e),r=this._comparator;null!==t.data()&&0===r(t.data(),e);)t.next();return t},t.prototype.min=function(){var e=this._root;if(null===e)return null;for(;null!==e.left;)e=e.left;return e.data},t.prototype.max=function(){var e=this._root;if(null===e)return null;for(;null!==e.right;)e=e.right;return e.data},t.prototype.iterator=function(){return new r(this)},t.prototype.each=function(e){for(var t,r=this.iterator();null!==(t=r.next());)if(!1===e(t))return},t.prototype.reach=function(e){for(var t,r=this.iterator();null!==(t=r.prev());)if(!1===e(t))return},r.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},r.prototype.next=function(){if(null===this._cursor){var e=this._tree._root;null!==e&&this._minNode(e)}else{var t;if(null===this._cursor.right)do{if(t=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===t);else this._ancestors.push(this._cursor),this._minNode(this._cursor.right)}return null!==this._cursor?this._cursor.data:null},r.prototype.prev=function(){if(null===this._cursor){var e=this._tree._root;null!==e&&this._maxNode(e)}else{var t;if(null===this._cursor.left)do{if(t=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===t);else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left)}return null!==this._cursor?this._cursor.data:null},r.prototype._minNode=function(e){for(;null!==e.left;)this._ancestors.push(e),e=e.left;this._cursor=e},r.prototype._maxNode=function(e){for(;null!==e.right;)this._ancestors.push(e),e=e.right;this._cursor=e},e.exports=t},95:e=>{"use strict";function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r(e,t,n,s){var o=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(o,r.prototype),o.expected=t,o.found=n,o.location=s,o.name="SyntaxError",o}function n(e,t,r){return r=r||" ",e.length>t?e:(t-=e.length,e+(r+=r.repeat(t)).slice(0,t))}!function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(r,Error),r.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var r,s=null;for(r=0;r<e.length;r++)if(e[r].source===this.location.source){s=e[r].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,i=this.location.source+":"+o.line+":"+o.column;if(s){var a=this.location.end,l=n("",o.line.toString().length," "),u=s[o.line-1],c=(o.line===a.line?a.column:u.length+1)-o.column||1;t+="\n --\x3e "+i+"\n"+l+" |\n"+o.line+" | "+u+"\n"+l+" | "+n("",o.column-1," ")+n("",c,"^")}else t+="\n at "+i}return t},r.buildMessage=function(e,t){var r={literal:function(e){return'"'+s(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?o(e[0])+"-"+o(e[1]):o(e)}));return"["+(e.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function s(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function i(e){return r[e.type](e)}return"Expected "+function(e){var t,r,n=e.map(i);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+s(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:r,parse:function(e,n){var s,o,i,a,l={},u=(n=void 0!==n?n:{}).grammarSource,c={Query:Hn},f=Hn,h="resource",p="all",g="id",d="name",y="regex",m="whereProperties",E="whereMetrics",q="and",v="or",w="avg",T="min",R="max",_="sum",A="count",O="variance",S="stddev",b="percentile",N="mavg",C="mstddev",I="mvariance",P="mmedian",L="mmax",D="mmin",M="msum",k="mexpavg",x="mgaussian",U="s",F="m",K="h",V="d",B="w",H="y",G="=",Y="!=",j="<",W=">",z="<=",X=">=",Q="in",$="not in",J="not exists",Z="exists",ee="contains",te="starts_with",re="ends_with",ne="not starts_with",se="not ends_with",oe="not contains",ie="not regex",ae="whereState",le="whereStatus",ue="whereHealth",ce="whereTags",fe="metrics",he="\\",pe=".",ge=",",de="(",ye=")",me="number",Ee="-",qe="true",ve="false",we='"',Te="/",Re="b",_e="f",Ae="n",Oe="r",Se="t",be="u",Ne="`",Ce=/^[A-Za-z0-9_:|.\-]/,Ie=/^[A-Za-z0-9_:|.\- ,$]/,Pe=/^[A-Za-z_]/,Le=/^[ \t\n\r]/,De=/^[^\0-\x1F"\\]/,Me=/^[0-9]/,ke=/^[0-9a-f]/,xe=xn("resource",!1),Ue=xn("all",!1),Fe=xn("id",!1),Ke=xn("name",!1),Ve=xn("regex",!1),Be=xn("whereProperties",!1),He=xn("whereMetrics",!1),Ge=xn("and",!1),Ye=xn("or",!1),je=xn("avg",!1),We=xn("min",!1),ze=xn("max",!1),Xe=xn("sum",!1),Qe=xn("count",!1),$e=xn("variance",!1),Je=xn("stddev",!1),Ze=xn("percentile",!1),et=xn("mavg",!1),tt=xn("mstddev",!1),rt=xn("mvariance",!1),nt=xn("mmedian",!1),st=xn("mmax",!1),ot=xn("mmin",!1),it=xn("msum",!1),at=xn("mexpavg",!1),lt=xn("mgaussian",!1),ut=xn("s",!1),ct=xn("m",!1),ft=xn("h",!1),ht=xn("d",!1),pt=xn("w",!1),gt=xn("y",!1),dt=xn("=",!1),yt=xn("!=",!1),mt=xn("<",!1),Et=xn(">",!1),qt=xn("<=",!1),vt=xn(">=",!1),wt=xn("in",!1),Tt=xn("not in",!1),Rt=xn("not exists",!1),_t=xn("exists",!1),At=xn("contains",!1),Ot=xn("starts_with",!1),St=xn("ends_with",!1),bt=xn("not starts_with",!1),Nt=xn("not ends_with",!1),Ct=xn("not contains",!1),It=xn("not regex",!1),Pt=xn("whereState",!1),Lt=xn("whereStatus",!1),Dt=xn("whereHealth",!1),Mt=xn("whereTags",!1),kt=xn("metrics",!1),xt=Un([["A","Z"],["a","z"],["0","9"],"_",":","|",".","-"],!1,!1),Ut=Un([["A","Z"],["a","z"],["0","9"],"_",":","|",".","-"," ",",","$"],!1,!1),Ft=Un([["A","Z"],["a","z"],"_"],!1,!1),Kt=xn("\\",!1),Vt=xn(".",!1),Bt=xn(",",!1),Ht=xn("(",!1),Gt=xn(")",!1),Yt=xn("number",!1),jt=Fn("integer"),Wt=xn("-",!1),zt=Fn("number"),Xt=xn("true",!1),Qt=xn("false",!1),$t=Fn("whitespace"),Jt=Un([" ","\t","\n","\r"],!1,!1),Zt=Fn("string"),er=xn('"',!1),tr=xn("/",!1),rr=xn("b",!1),nr=xn("f",!1),sr=xn("n",!1),or=xn("r",!1),ir=xn("t",!1),ar=xn("u",!1),lr=xn("`",!1),ur=Un([["\0",""],'"',"\\"],!0,!1),cr=Un([["0","9"]],!1,!1),fr=Un([["0","9"],["a","f"]],!1,!1),hr=function(e,t,r,n,s){return{type:e,instances:t,metrics:r,slidingWindow:s,aggregation:n}},pr=function(e){return e},gr=function(e){return e},dr=function(e,t){return[e,...t]},yr=function(e){return e},mr=function(e){return{type:e,arg:[]}},Er=function(e,t){return{type:e,arg:t}},qr=function(e,t){return{type:e,arg:t}},vr=function(e,t){return{type:e,arg:t}},wr=function(e,t){return{type:e,arg:t}},Tr=function(e,t){return[e,...t]},Rr=function(e,r){return n=function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},s=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),s.forEach((function(r){t(e,r,n[r])}))}return e}({},r),s=null!=(s={conjunctive:e.toUpperCase()})?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(s)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(s,e))})),n;var n,s},_r=function(e,t){return{name:e.toUpperCase(),arg:[t]}},Ar=function(e,t,r){return{name:e.toUpperCase(),arg:[t,r]}},Or=function(e,t,r){return{name:t,arg:[e,r]}},Sr=function(e){return e},br=function(e,t){return[e,...t]},Nr=function(e){return e},Cr=function(e,t){return{type:e,properties:t}},Ir=function(e,t,r){return r},Pr=function(e,t,r){return{type:e,parameter:t,properties:r}},Lr=function(e,t,r){return r},Dr=function(e,t,r){return{type:e,params:{duration:t,shift:r}}},Mr=function(e,t){return e*t},kr=function(){return 1e3},xr=function(){return 6e4},Ur=function(){return 36e5},Fr=function(){return 864e5},Kr=function(){return 6048e5},Vr=function(){return 31536e6},Br=function(){return"EQ"},Hr=function(){return"NE"},Gr=function(){return"LT"},Yr=function(){return"GT"},jr=function(){return"LT_EQ"},Wr=function(){return"GT_EQ"},zr=function(){return"IN"},Xr=function(){return"NOT_IN"},Qr=function(){return kn().replace(" ","_").toUpperCase()},$r=function(){return kn().replace(" ","_").toUpperCase()},Jr=function(e,t){return{type:e,arg:t}},Zr=function(e,t){return{type:e,arg:t}},en=function(e,t){return{type:e,arg:t}},tn=function(e,t){return{type:e,arg:t}},rn=function(e){return e},nn=function(){return kn()},sn=function(){return kn()},on=function(){return kn()},an=function(e,t){return e+(t||"")},ln=function(e){return e},un=function(e,t){return[e,...t]},cn=function(e){return e},fn=function(e,t){return[e,...t]},hn=function(e,t){return[e,...t]},pn=function(e){return e},gn=function(e,t){return[e,...t]},dn=function(e){return e},yn=function(e){return e.join("")},mn=function(){return parseInt(kn(),10)},En=function(){return parseFloat(kn())},qn=function(e){return e},vn=function(){return!0},wn=function(){return!1},Tn=function(e){return e.join("")},Rn=function(){return"\b"},_n=function(){return"\f"},An=function(){return"\n"},On=function(){return"\r"},Sn=function(){return"\t"},bn=function(e){return String.fromCharCode(parseInt(e,16))},Nn=function(e){return e},Cn=0,In=0,Pn=[{line:1,column:1}],Ln=0,Dn=[],Mn=0;if("startRule"in n){if(!(n.startRule in c))throw new Error("Can't start parsing from rule \""+n.startRule+'".');f=c[n.startRule]}function kn(){return e.substring(In,Cn)}function xn(e,t){return{type:"literal",text:e,ignoreCase:t}}function Un(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function Fn(e){return{type:"other",description:e}}function Kn(t){var r,n=Pn[t];if(n)return n;for(r=t-1;!Pn[r];)r--;for(n={line:(n=Pn[r]).line,column:n.column};r<t;)10===e.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Pn[t]=n,n}function Vn(e,t){var r=Kn(e),n=Kn(t);return{source:u,start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function Bn(e){Cn<Ln||(Cn>Ln&&(Ln=Cn,Dn=[]),Dn.push(e))}function Hn(){var t,r,n,s,o,i;return t=Cn,us(),r=function(){var t,r,n;return t=Cn,e.substr(Cn,8)===h?(r=h,Cn+=8):(r=l,0===Mn&&Bn(xe)),r!==l&&is()!==l&&(n=$n())!==l&&as()!==l?(In=t,t=pr(n)):(Cn=t,t=l),t}(),r!==l&&ss()!==l?(n=function(){var e,t;return e=Cn,t=function(){var e,t,r,n;if(e=Cn,(t=Yn())!==l){for(r=[],n=Gn();n!==l;)r.push(n),n=Gn();In=e,e=dr(t,r)}else Cn=e,e=l;return e}(),t!==l&&(In=e,t=gr(t)),e=t}(),n!==l?(us(),s=function(){var t,r,n;return t=Cn,ss()!==l?(e.substr(Cn,7)===fe?(r=fe,Cn+=7):(r=l,0===Mn&&Bn(kt)),r!==l&&is()!==l&&(n=$n())!==l?(us(),as()!==l?(In=t,t=rn(n)):(Cn=t,t=l)):(Cn=t,t=l)):(Cn=t,t=l),t}(),s===l&&(s=null),o=function(){var t;return t=function(){var t,r,n,s,o;return t=Cn,ss()!==l?(r=function(){var t;return e.substr(Cn,10)===b?(t=b,Cn+=10):(t=l,0===Mn&&Bn(Ze)),t}(),r!==l&&is()!==l&&(n=ls())!==l?(s=Cn,os()!==l&&(o=$n())!==l?(In=s,s=Ir(r,n,o)):(Cn=s,s=l),s===l&&(s=null),as()!==l?(In=t,t=Pr(r,n,s)):(Cn=t,t=l)):(Cn=t,t=l)):(Cn=t,t=l),t}(),t===l&&(t=function(){var t,r,n;return t=Cn,ss()!==l?(r=function(){var t;return e.substr(Cn,3)===w?(t=w,Cn+=3):(t=l,0===Mn&&Bn(je)),t===l&&(e.substr(Cn,3)===T?(t=T,Cn+=3):(t=l,0===Mn&&Bn(We)),t===l&&(e.substr(Cn,3)===R?(t=R,Cn+=3):(t=l,0===Mn&&Bn(ze)),t===l&&(e.substr(Cn,3)===_?(t=_,Cn+=3):(t=l,0===Mn&&Bn(Xe)),t===l&&(e.substr(Cn,5)===A?(t=A,Cn+=5):(t=l,0===Mn&&Bn(Qe)),t===l&&(e.substr(Cn,8)===O?(t=O,Cn+=8):(t=l,0===Mn&&Bn($e)),t===l&&(e.substr(Cn,6)===S?(t=S,Cn+=6):(t=l,0===Mn&&Bn(Je)))))))),t}(),r!==l&&is()!==l?((n=$n())===l&&(n=null),as()!==l?(In=t,t=Cr(r,n)):(Cn=t,t=l)):(Cn=t,t=l)):(Cn=t,t=l),t}()),t}(),o===l&&(o=null),i=function(){var t,r,n,s,o;return t=Cn,ss()!==l?(r=function(){var t;return e.substr(Cn,4)===N?(t=N,Cn+=4):(t=l,0===Mn&&Bn(et)),t===l&&(e.substr(Cn,7)===C?(t=C,Cn+=7):(t=l,0===Mn&&Bn(tt)),t===l&&(e.substr(Cn,9)===I?(t=I,Cn+=9):(t=l,0===Mn&&Bn(rt)),t===l&&(e.substr(Cn,7)===P?(t=P,Cn+=7):(t=l,0===Mn&&Bn(nt)),t===l&&(e.substr(Cn,4)===L?(t=L,Cn+=4):(t=l,0===Mn&&Bn(st)),t===l&&(e.substr(Cn,4)===D?(t=D,Cn+=4):(t=l,0===Mn&&Bn(ot)),t===l&&(e.substr(Cn,4)===M?(t=M,Cn+=4):(t=l,0===Mn&&Bn(it)),t===l&&(e.substr(Cn,7)===k?(t=k,Cn+=7):(t=l,0===Mn&&Bn(at)),t===l&&(e.substr(Cn,9)===x?(t=x,Cn+=9):(t=l,0===Mn&&Bn(lt)))))))))),t}(),r!==l&&is()!==l?(n=function(){var t,r,n;return t=Cn,(r=ls())!==l?(n=function(){var t,r;return t=Cn,115===e.charCodeAt(Cn)?(r=U,Cn++):(r=l,0===Mn&&Bn(ut)),r!==l&&(In=t,r=kr()),(t=r)===l&&(t=Cn,109===e.charCodeAt(Cn)?(r=F,Cn++):(r=l,0===Mn&&Bn(ct)),r!==l&&(In=t,r=xr()),(t=r)===l&&(t=Cn,104===e.charCodeAt(Cn)?(r=K,Cn++):(r=l,0===Mn&&Bn(ft)),r!==l&&(In=t,r=Ur()),(t=r)===l&&(t=Cn,100===e.charCodeAt(Cn)?(r=V,Cn++):(r=l,0===Mn&&Bn(ht)),r!==l&&(In=t,r=Fr()),(t=r)===l&&(t=Cn,119===e.charCodeAt(Cn)?(r=B,Cn++):(r=l,0===Mn&&Bn(pt)),r!==l&&(In=t,r=Kr()),(t=r)===l&&(t=Cn,121===e.charCodeAt(Cn)?(r=H,Cn++):(r=l,0===Mn&&Bn(gt)),r!==l&&(In=t,r=Vr()),t=r))))),t}(),n!==l?(In=t,t=Mr(r,n)):(Cn=t,t=l)):(Cn=t,t=l),t}(),n!==l?(s=Cn,os()!==l?(o=function(){var t,r;return t=Cn,us(),r=function(){var t,r;return t=Cn,e.substr(Cn,4)===qe?(r=qe,Cn+=4):(r=l,0===Mn&&Bn(Xt)),r!==l&&(In=t,r=vn()),t=r}(),r===l&&(r=function(){var t,r;return t=Cn,e.substr(Cn,5)===ve?(r=ve,Cn+=5):(r=l,0===Mn&&Bn(Qt)),r!==l&&(In=t,r=wn()),t=r}()),r!==l?(us(),In=t,t=qn(r)):(Cn=t,t=l),t}(),o!==l?(In=s,s=Lr(r,n,o)):(Cn=s,s=l)):(Cn=s,s=l),s===l&&(s=null),as()!==l?(In=t,t=Dr(r,n,s)):(Cn=t,t=l)):(Cn=t,t=l)):(Cn=t,t=l)):(Cn=t,t=l),t}(),i===l&&(i=null),In=t,t=hr(r,n,s,o,i)):(Cn=t,t=l)):(Cn=t,t=l),t}function Gn(){var e,t;return e=Cn,ss()!==l&&(t=Yn())!==l?(In=e,e=yr(t)):(Cn=e,e=l),e}function Yn(){var t;return(t=function(){var t,r;return t=Cn,e.substr(Cn,3)===p?(r=p,Cn+=3):(r=l,0===Mn&&Bn(Ue)),r!==l&&is()!==l&&as()!==l?(In=t,t=mr(r)):(Cn=t,t=l),t}())===l&&(t=function(){var t,r,n;return t=Cn,e.substr(Cn,2)===g?(r=g,Cn+=2):(r=l,0===Mn&&Bn(Fe)),r!==l&&is()!==l&&(n=es())!==l&&as()!==l?(In=t,t=Er(r,n)):(Cn=t,t=l),t}())===l&&(t=function(){var t,r,n;return t=Cn,e.substr(Cn,4)===d?(r=d,Cn+=4):(r=l,0===Mn&&Bn(Ke)),r!==l&&is()!==l&&(n=es())!==l&&as()!==l?(In=t,t=qr(r,n)):(Cn=t,t=l),t}())===l&&(t=function(){var t,r,n;return t=Cn,e.substr(Cn,5)===y?(r=y,Cn+=5):(r=l,0===Mn&&Bn(Ve)),r!==l&&is()!==l?(n=function(){var e,t,r,n;if(e=Cn,(t=ns())!==l){for(r=[],n=rs();n!==l;)r.push(n),n=rs();In=e,e=gn(t,r)}else Cn=e,e=l;return e}(),n!==l&&as()!==l?(In=t,t=vr(r,n)):(Cn=t,t=l)):(Cn=t,t=l),t}())===l&&(t=function(){var t,r,n;return t=Cn,e.substr(Cn,11)===ue?(r=ue,Cn+=11):(r=l,0===Mn&&Bn(Dt)),r!==l&&is()!==l&&(n=Zn())!==l&&as()!==l?(In=t,t=en(r,n)):(Cn=t,t=l),t}())===l&&(t=function(){var t,r,n;return t=Cn,e.substr(Cn,10)===ae?(r=ae,Cn+=10):(r=l,0===Mn&&Bn(Pt)),r!==l&&is()!==l&&(n=Zn())!==l&&as()!==l?(In=t,t=Jr(r,n)):(Cn=t,t=l),t}())===l&&(t=function(){var t,r,n;return t=Cn,e.substr(Cn,11)===le?(r=le,Cn+=11):(r=l,0===Mn&&Bn(Lt)),r!==l&&is()!==l&&(n=Zn())!==l&&as()!==l?(In=t,t=Zr(r,n)):(Cn=t,t=l),t}())===l&&(t=function(){var t,r,n;return t=Cn,e.substr(Cn,9)===ce?(r=ce,Cn+=9):(r=l,0===Mn&&Bn(Mt)),r!==l&&is()!==l&&(n=Zn())!==l&&as()!==l?(In=t,t=tn(r,n)):(Cn=t,t=l),t}())===l&&(t=function(){var t,r,n;return t=Cn,e.substr(Cn,15)===m?(r=m,Cn+=15):(r=l,0===Mn&&Bn(Be)),r===l&&(e.substr(Cn,12)===E?(r=E,Cn+=12):(r=l,0===Mn&&Bn(He))),r!==l&&is()!==l?(n=function(){var e,t,r,n;if(e=Cn,(t=Wn())!==l){for(us(),r=[],n=jn();n!==l;)r.push(n),n=jn();In=e,e=Tr(t,r)}else Cn=e,e=l;return e}(),n!==l&&as()!==l?(In=t,t=wr(r,n)):(Cn=t,t=l)):(Cn=t,t=l),t}()),t}function jn(){var t,r,n;return t=Cn,us(),e.substr(Cn,3)===q?(r=q,Cn+=3):(r=l,0===Mn&&Bn(Ge)),r===l&&(e.substr(Cn,2)===v?(r=v,Cn+=2):(r=l,0===Mn&&Bn(Ye))),r!==l?(us(),(n=Wn())!==l?(In=t,t=Rr(r,n)):(Cn=t,t=l)):(Cn=t,t=l),t}function Wn(){var t;return(t=function(){var t;return(t=function(){var t,r,n;return t=Cn,r=function(){var t,r;return t=Cn,e.substr(Cn,10)===J?(r=J,Cn+=10):(r=l,0===Mn&&Bn(Rt)),r===l&&(e.substr(Cn,6)===Z?(r=Z,Cn+=6):(r=l,0===Mn&&Bn(_t))),r!==l&&(In=t,r=Qr()),t=r}(),r!==l&&is()!==l&&(n=Qn())!==l&&as()!==l?(In=t,t=_r(r,n)):(Cn=t,t=l),t}())===l&&(t=function(){var t,r,n,s;return t=Cn,r=function(){var t,r;return t=Cn,e.substr(Cn,8)===ee?(r=ee,Cn+=8):(r=l,0===Mn&&Bn(At)),r===l&&(e.substr(Cn,11)===te?(r=te,Cn+=11):(r=l,0===Mn&&Bn(Ot)),r===l&&(e.substr(Cn,9)===re?(r=re,Cn+=9):(r=l,0===Mn&&Bn(St)),r===l&&(e.substr(Cn,15)===ne?(r=ne,Cn+=15):(r=l,0===Mn&&Bn(bt)),r===l&&(e.substr(Cn,13)===se?(r=se,Cn+=13):(r=l,0===Mn&&Bn(Nt)),r===l&&(e.substr(Cn,12)===oe?(r=oe,Cn+=12):(r=l,0===Mn&&Bn(Ct)),r===l&&(e.substr(Cn,5)===y?(r=y,Cn+=5):(r=l,0===Mn&&Bn(Ve)),r===l&&(e.substr(Cn,9)===ie?(r=ie,Cn+=9):(r=l,0===Mn&&Bn(It))))))))),r!==l&&(In=t,r=$r()),t=r}(),r!==l&&is()!==l&&(n=Qn())!==l&&os()!==l&&(s=zn())!==l&&as()!==l?(In=t,t=Ar(r,n,s)):(Cn=t,t=l),t}()),t}())===l&&(t=function(){var t,r,n,s;return t=Cn,(r=Qn())!==l?(us(),n=function(){var t;return t=function(){var t,r;return t=Cn,61===e.charCodeAt(Cn)?(r=G,Cn++):(r=l,0===Mn&&Bn(dt)),r!==l&&(In=t,r=Br()),t=r}(),t===l&&(t=function(){var t,r;return t=Cn,e.substr(Cn,2)===Y?(r=Y,Cn+=2):(r=l,0===Mn&&Bn(yt)),r!==l&&(In=t,r=Hr()),t=r}(),t===l&&(t=function(){var t,r;return t=Cn,60===e.charCodeAt(Cn)?(r=j,Cn++):(r=l,0===Mn&&Bn(mt)),r!==l&&(In=t,r=Gr()),t=r}(),t===l&&(t=function(){var t,r;return t=Cn,62===e.charCodeAt(Cn)?(r=W,Cn++):(r=l,0===Mn&&Bn(Et)),r!==l&&(In=t,r=Yr()),t=r}(),t===l&&(t=function(){var t,r;return t=Cn,e.substr(Cn,2)===z?(r=z,Cn+=2):(r=l,0===Mn&&Bn(qt)),r!==l&&(In=t,r=jr()),t=r}(),t===l&&(t=function(){var t,r;return t=Cn,e.substr(Cn,2)===X?(r=X,Cn+=2):(r=l,0===Mn&&Bn(vt)),r!==l&&(In=t,r=Wr()),t=r}(),t===l&&(t=function(){var t,r;return t=Cn,e.substr(Cn,2)===Q?(r=Q,Cn+=2):(r=l,0===Mn&&Bn(wt)),r!==l&&(In=t,r=zr()),t=r}(),t===l&&(t=function(){var t,r;return t=Cn,e.substr(Cn,6)===$?(r=$,Cn+=6):(r=l,0===Mn&&Bn(Tt)),r!==l&&(In=t,r=Xr()),t=r}()))))))),t}(),n!==l?(us(),(s=zn())!==l?(In=t,t=Or(r,n,s)):(Cn=t,t=l)):(Cn=t,t=l)):(Cn=t,t=l),t}()),t}function zn(){var e,t;return(e=cs())===l&&(e=ls())===l&&(e=Cn,is()!==l?(t=function(){var e,t,r,n;if(e=Cn,(t=zn())!==l){for(r=[],n=Xn();n!==l;)r.push(n),n=Xn();In=e,e=br(t,r)}else Cn=e,e=l;return e}(),t!==l&&as()!==l?(In=e,e=Sr(t)):(Cn=e,e=l)):(Cn=e,e=l)),e}function Xn(){var e,t;return e=Cn,os()!==l&&(t=zn())!==l?(In=e,e=Nr(t)):(Cn=e,e=l),e}function Qn(){var t,r,n;return t=Cn,r=function(){var t,r;return t=Cn,Pe.test(e.charAt(Cn))?(r=e.charAt(Cn),Cn++):(r=l,0===Mn&&Bn(Ft)),r!==l&&(In=t,r=on()),r}(),r!==l?(n=function(){var t,r,n;if(t=Cn,r=[],Ce.test(e.charAt(Cn))?(n=e.charAt(Cn),Cn++):(n=l,0===Mn&&Bn(xt)),n!==l)for(;n!==l;)r.push(n),Ce.test(e.charAt(Cn))?(n=e.charAt(Cn),Cn++):(n=l,0===Mn&&Bn(xt));else r=l;return r!==l&&(In=t,r=nn()),r}(),n===l&&(n=null),In=t,t=an(r,n)):(Cn=t,t=l),t===l&&(t=Cn,(r=ps())!==l?(n=function(){var t,r,n;if(t=Cn,r=[],Ie.test(e.charAt(Cn))?(n=e.charAt(Cn),Cn++):(n=l,0===Mn&&Bn(Ut)),n!==l)for(;n!==l;)r.push(n),Ie.test(e.charAt(Cn))?(n=e.charAt(Cn),Cn++):(n=l,0===Mn&&Bn(Ut));else r=l;return r!==l&&(In=t,r=sn()),r}(),n!==l&&ps()!==l?(In=t,t=ln(n)):(Cn=t,t=l)):(Cn=t,t=l)),t}function $n(){var e,t,r,n;if(e=Cn,(t=Qn())!==l){for(r=[],n=Jn();n!==l;)r.push(n),n=Jn();In=e,e=un(t,r)}else Cn=e,e=l;return e}function Jn(){var e,t;return e=Cn,os()!==l&&(t=Qn())!==l?(In=e,e=cn(t)):(Cn=e,e=l),e}function Zn(){var e,t,r,n;if(e=Cn,(t=Qn())===l&&(t=cs()),t!==l){for(r=[],n=Jn();n!==l;)r.push(n),n=Jn();In=e,e=fn(t,r)}else Cn=e,e=l;return e}function es(){var e,t,r,n;if(e=Cn,(t=cs())!==l){for(r=[],n=ts();n!==l;)r.push(n),n=ts();In=e,e=hn(t,r)}else Cn=e,e=l;return e}function ts(){var e,t;return e=Cn,os()!==l&&(t=cs())!==l?(In=e,e=pn(t)):(Cn=e,e=l),e}function rs(){var e,t;return e=Cn,os()!==l&&(t=ns())!==l?(In=e,e=dn(t)):(Cn=e,e=l),e}function ns(){var t,r,n;if(t=Cn,hs()!==l){if(r=[],(n=gs())===l&&(92===e.charCodeAt(Cn)?(n=he,Cn++):(n=l,0===Mn&&Bn(Kt))),n!==l)for(;n!==l;)r.push(n),(n=gs())===l&&(92===e.charCodeAt(Cn)?(n=he,Cn++):(n=l,0===Mn&&Bn(Kt)));else r=l;r!==l&&(n=hs())!==l?(In=t,t=yn(r)):(Cn=t,t=l)}else Cn=t,t=l;return t}function ss(){var t,r,n;return t=Cn,r=us(),46===e.charCodeAt(Cn)?(n=pe,Cn++):(n=l,0===Mn&&Bn(Vt)),n!==l?t=r=[r,n,us()]:(Cn=t,t=l),t}function os(){var t,r,n;return t=Cn,r=us(),44===e.charCodeAt(Cn)?(n=ge,Cn++):(n=l,0===Mn&&Bn(Bt)),n!==l?t=r=[r,n,us()]:(Cn=t,t=l),t}function is(){var t,r,n;return t=Cn,r=us(),40===e.charCodeAt(Cn)?(n=de,Cn++):(n=l,0===Mn&&Bn(Ht)),n!==l?t=r=[r,n,us()]:(Cn=t,t=l),t}function as(){var t,r,n;return t=Cn,r=us(),41===e.charCodeAt(Cn)?(n=ye,Cn++):(n=l,0===Mn&&Bn(Gt)),n!==l?t=r=[r,n,us()]:(Cn=t,t=l),t}function ls(){var t,r,n;return t=Cn,e.substr(Cn,6)===me?(r=me,Cn+=6):(r=l,0===Mn&&Bn(Yt)),r!==l?(n=function(){var t,r,n,s;if(Mn++,t=Cn,us(),45===e.charCodeAt(Cn)?(r=Ee,Cn++):(r=l,0===Mn&&Bn(Wt)),r===l&&(r=null),n=[],(s=ds())!==l)for(;s!==l;)n.push(s),s=ds();else n=l;return n!==l?(In=t,t=mn()):(Cn=t,t=l),Mn--,t===l&&0===Mn&&Bn(jt),t}(),n!==l?t=r=[r,n]:(Cn=t,t=l)):(Cn=t,t=l),t===l&&(t=function(){var t,r,n,s,o,i,a,u;if(Mn++,t=Cn,us(),45===e.charCodeAt(Cn)?(r=Ee,Cn++):(r=l,0===Mn&&Bn(Wt)),r===l&&(r=null),n=[],(s=ds())!==l)for(;s!==l;)n.push(s),s=ds();else n=l;if(n!==l){if(s=[],o=Cn,46===e.charCodeAt(Cn)?(i=pe,Cn++):(i=l,0===Mn&&Bn(Vt)),i!==l){if(a=[],(u=ds())!==l)for(;u!==l;)a.push(u),u=ds();else a=l;a!==l?o=i=[i,a]:(Cn=o,o=l)}else Cn=o,o=l;for(;o!==l;)if(s.push(o),o=Cn,46===e.charCodeAt(Cn)?(i=pe,Cn++):(i=l,0===Mn&&Bn(Vt)),i!==l){if(a=[],(u=ds())!==l)for(;u!==l;)a.push(u),u=ds();else a=l;a!==l?o=i=[i,a]:(Cn=o,o=l)}else Cn=o,o=l;In=t,t=En()}else Cn=t,t=l;return Mn--,t===l&&0===Mn&&Bn(zt),t}()),t}function us(){var t,r;for(Mn++,t=[],Le.test(e.charAt(Cn))?(r=e.charAt(Cn),Cn++):(r=l,0===Mn&&Bn(Jt));r!==l;)t.push(r),Le.test(e.charAt(Cn))?(r=e.charAt(Cn),Cn++):(r=l,0===Mn&&Bn(Jt));return Mn--,r=l,0===Mn&&Bn($t),t}function cs(){var e,t,r;if(Mn++,e=Cn,hs()!==l){for(t=[],r=fs();r!==l;)t.push(r),r=fs();(r=hs())!==l?(In=e,e=Tn(t)):(Cn=e,e=l)}else Cn=e,e=l;return Mn--,e===l&&0===Mn&&Bn(Zt),e}function fs(){var t,r,n,s,o,i,a,u,c,f;return(t=gs())===l&&(t=Cn,r=function(){var t;return 92===e.charCodeAt(Cn)?(t=he,Cn++):(t=l,0===Mn&&Bn(Kt)),t}(),r!==l?(34===e.charCodeAt(Cn)?(n=we,Cn++):(n=l,0===Mn&&Bn(er)),n===l&&(92===e.charCodeAt(Cn)?(n=he,Cn++):(n=l,0===Mn&&Bn(Kt)),n===l&&(47===e.charCodeAt(Cn)?(n=Te,Cn++):(n=l,0===Mn&&Bn(tr)),n===l&&(n=Cn,98===e.charCodeAt(Cn)?(s=Re,Cn++):(s=l,0===Mn&&Bn(rr)),s!==l&&(In=n,s=Rn()),(n=s)===l&&(n=Cn,102===e.charCodeAt(Cn)?(s=_e,Cn++):(s=l,0===Mn&&Bn(nr)),s!==l&&(In=n,s=_n()),(n=s)===l&&(n=Cn,110===e.charCodeAt(Cn)?(s=Ae,Cn++):(s=l,0===Mn&&Bn(sr)),s!==l&&(In=n,s=An()),(n=s)===l&&(n=Cn,114===e.charCodeAt(Cn)?(s=Oe,Cn++):(s=l,0===Mn&&Bn(or)),s!==l&&(In=n,s=On()),(n=s)===l&&(n=Cn,116===e.charCodeAt(Cn)?(s=Se,Cn++):(s=l,0===Mn&&Bn(ir)),s!==l&&(In=n,s=Sn()),(n=s)===l&&(n=Cn,117===e.charCodeAt(Cn)?(s=be,Cn++):(s=l,0===Mn&&Bn(ar)),s!==l?(o=Cn,i=Cn,(a=ys())!==l&&(u=ys())!==l&&(c=ys())!==l&&(f=ys())!==l?i=a=[a,u,c,f]:(Cn=i,i=l),(o=i!==l?e.substring(o,Cn):i)!==l?(In=n,n=bn(o)):(Cn=n,n=l)):(Cn=n,n=l))))))))),n!==l?(In=t,t=Nn(n)):(Cn=t,t=l)):(Cn=t,t=l)),t}function hs(){var t;return 34===e.charCodeAt(Cn)?(t=we,Cn++):(t=l,0===Mn&&Bn(er)),t}function ps(){var t;return 96===e.charCodeAt(Cn)?(t=Ne,Cn++):(t=l,0===Mn&&Bn(lr)),t}function gs(){var t;return De.test(e.charAt(Cn))?(t=e.charAt(Cn),Cn++):(t=l,0===Mn&&Bn(ur)),t}function ds(){var t;return Me.test(e.charAt(Cn))?(t=e.charAt(Cn),Cn++):(t=l,0===Mn&&Bn(cr)),t}function ys(){var t;return ke.test(e.charAt(Cn))?(t=e.charAt(Cn),Cn++):(t=l,0===Mn&&Bn(fr)),t}if((s=f())!==l&&Cn===e.length)return s;throw s!==l&&Cn<e.length&&Bn({type:"end"}),o=Dn,i=Ln<e.length?e.charAt(Ln):null,a=Ln<e.length?Vn(Ln,Ln+1):Vn(Ln,Ln),new r(r.buildMessage(o,i),o,i,a)}}},705:(e,t,r)=>{var n=r(646).RBTree;function s(e,t,r){this.discrete=!1===e,this.delta=e||.01,this.K=void 0===t?25:t,this.CX=void 0===r?1.1:r,this.centroids=new n(o),this.nreset=0,this.reset()}function o(e,t){return e.mean>t.mean?1:e.mean<t.mean?-1:0}function i(e,t){return e.mean_cumn-t.mean_cumn}function a(e){this.config=e||{},this.mode=this.config.mode||"auto",s.call(this,"cont"===this.mode&&e.delta),this.digest_ratio=this.config.ratio||.9,this.digest_thresh=this.config.thresh||1e3,this.n_unique=0}s.prototype.reset=function(){this.centroids.clear(),this.n=0,this.nreset+=1,this.last_cumulate=0},s.prototype.size=function(){return this.centroids.size},s.prototype.toArray=function(e){var t=[];return e?(this._cumulate(!0),this.centroids.each((function(e){t.push(e)}))):this.centroids.each((function(e){t.push({mean:e.mean,n:e.n})})),t},s.prototype.summary=function(){return[(this.discrete?"exact ":"approximating ")+this.n+" samples using "+this.size()+" centroids","min = "+this.percentile(0),"Q1  = "+this.percentile(.25),"Q2  = "+this.percentile(.5),"Q3  = "+this.percentile(.75),"max = "+this.percentile(1)].join("\n")},s.prototype.push=function(e,t){t=t||1,e=Array.isArray(e)?e:[e];for(var r=0;r<e.length;r++)this._digest(e[r],t)},s.prototype.push_centroid=function(e){e=Array.isArray(e)?e:[e];for(var t=0;t<e.length;t++)this._digest(e[t].mean,e[t].n)},s.prototype._cumulate=function(e){if(!(this.n===this.last_cumulate||!e&&this.CX&&this.CX>this.n/this.last_cumulate)){var t=0;this.centroids.each((function(e){e.mean_cumn=t+e.n/2,t=e.cumn=t+e.n})),this.n=this.last_cumulate=t}},s.prototype.find_nearest=function(e){if(0===this.size())return null;var t=this.centroids.lowerBound({mean:e}),r=null===t.data()?t.prev():t.data();if(r.mean===e||this.discrete)return r;var n=t.prev();return n&&Math.abs(n.mean-e)<Math.abs(r.mean-e)?n:r},s.prototype._new_centroid=function(e,t,r){var n={mean:e,n:t,cumn:r};return this.centroids.insert(n),this.n+=t,n},s.prototype._addweight=function(e,t,r){t!==e.mean&&(e.mean+=r*(t-e.mean)/(e.n+r)),e.cumn+=r,e.mean_cumn+=r/2,e.n+=r,this.n+=r},s.prototype._digest=function(e,t){var r=this.centroids.min(),n=this.centroids.max(),s=this.find_nearest(e);if(s&&s.mean===e)this._addweight(s,e,t);else if(s===r)this._new_centroid(e,t,0);else if(s===n)this._new_centroid(e,t,this.n);else if(this.discrete)this._new_centroid(e,t,s.cumn);else{var o=s.mean_cumn/this.n;Math.floor(4*this.n*this.delta*o*(1-o))-s.n>=t?this._addweight(s,e,t):this._new_centroid(e,t,s.cumn)}this._cumulate(!1),!this.discrete&&this.K&&this.size()>this.K/this.delta&&this.compress()},s.prototype.bound_mean=function(e){var t=this.centroids.upperBound({mean:e}),r=t.prev();return[r,r.mean===e?r:t.next()]},s.prototype.p_rank=function(e){var t=(Array.isArray(e)?e:[e]).map(this._p_rank,this);return Array.isArray(e)?t:t[0]},s.prototype._p_rank=function(e){if(0!==this.size()){if(e<this.centroids.min().mean)return 0;if(e>this.centroids.max().mean)return 1;this._cumulate(!0);var t=this.bound_mean(e),r=t[0],n=t[1];if(this.discrete)return r.cumn/this.n;var s=r.mean_cumn;return r!==n&&(s+=(e-r.mean)*(n.mean_cumn-r.mean_cumn)/(n.mean-r.mean)),s/this.n}},s.prototype.bound_mean_cumn=function(e){this.centroids._comparator=i;var t=this.centroids.upperBound({mean_cumn:e});this.centroids._comparator=o;var r=t.prev();return[r,r&&r.mean_cumn===e?r:t.next()]},s.prototype.percentile=function(e){var t=(Array.isArray(e)?e:[e]).map(this._percentile,this);return Array.isArray(e)?t:t[0]},s.prototype._percentile=function(e){if(0!==this.size()){this._cumulate(!0);var t=this.n*e,r=this.bound_mean_cumn(t),n=r[0],s=r[1];return s===n||null===n||null===s?(n||s).mean:this.discrete?t<=n.cumn?n.mean:s.mean:n.mean+(t-n.mean_cumn)*(s.mean-n.mean)/(s.mean_cumn-n.mean_cumn)}},s.prototype.compress=function(){if(!this.compressing){var e,t,r=this.toArray();for(this.reset(),this.compressing=!0;r.length>0;)this.push_centroid((e=r,void 0,t=Math.floor(Math.random()*e.length),e.splice(t,1)[0]));this._cumulate(!0),this.compressing=!1}},a.prototype=Object.create(s.prototype),a.prototype.constructor=a,a.prototype.push=function(e){s.prototype.push.call(this,e),this.check_continuous()},a.prototype._new_centroid=function(e,t,r){this.n_unique+=1,s.prototype._new_centroid.call(this,e,t,r)},a.prototype._addweight=function(e,t,r){1===e.n&&(this.n_unique-=1),s.prototype._addweight.call(this,e,t,r)},a.prototype.check_continuous=function(){return!("auto"!==this.mode||this.size()<this.digest_thresh)&&this.n_unique/this.size()>this.digest_ratio&&(this.mode="cont",this.discrete=!1,this.delta=this.config.delta||.01,this.compress(),!0)},e.exports={TDigest:s,Digest:a}},644:e=>{"use strict";e.exports=i},305:t=>{"use strict";t.exports=e},545:e=>{"use strict";e.exports=t},388:e=>{"use strict";e.exports=o},980:e=>{"use strict";e.exports=r},650:e=>{"use strict";e.exports=s},177:e=>{"use strict";e.exports=n}},l={};function u(e){var t=l[e];if(void 0!==t)return t.exports;var r=l[e]={exports:{}};return a[e](r,r.exports,u),r.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var r in t)u.o(t,r)&&!u.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};return(()=>{"use strict";u.r(c),u.d(c,{plugin:()=>Je});var e=u(305),t=u(545),r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function s(e,t){var r,n,s,o,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(i=0)),i;)try{if(r=1,n&&(s=2&a[0]?n.return:a[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,a[1])).done)return s;switch(n=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((s=(s=i.trys).length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){i.label=a[1];break}if(6===a[0]&&i.label<s[1]){i.label=s[1],s=a;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(a);break}s[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function o(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function i(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,s,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(s)throw s.error}}return i}function a(e,t,r){if(r||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}function l(e){return this instanceof l?(this.v=e,this):new l(e)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var f=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function h(e){return"function"==typeof e}var p,g=((p=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),p.prototype.constructor=p,p);function d(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var y=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,r,n,s;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var u=o(l),c=u.next();!c.done;c=u.next())c.value.remove(this)}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}else l.remove(this);var f=this.initialTeardown;if(h(f))try{f()}catch(e){s=e instanceof g?e.errors:[e]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var d=o(p),y=d.next();!y.done;y=d.next()){var m=y.value;try{E(m)}catch(e){s=null!=s?s:[],e instanceof g?s=a(a([],i(s)),i(e.errors)):s.push(e)}}}catch(e){r={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}}if(s)throw new g(s)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)E(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&d(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&d(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function m(e){return e instanceof y||e&&"closed"in e&&h(e.remove)&&h(e.add)&&h(e.unsubscribe)}function E(e){h(e)?e():e.unsubscribe()}y.EMPTY;var q={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},v={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var s=v.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,a([e,t],i(r))):setTimeout.apply(void 0,a([e,t],i(r)))},clearTimeout:function(e){var t=v.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function w(e){v.setTimeout((function(){var t=q.onUnhandledError;if(!t)throw e;t(e)}))}function T(){}var R=_("C",void 0,void 0);function _(e,t,r){return{kind:e,value:t,error:r}}var A=null,O=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,m(t)&&t.add(r)):r.destination=L,r}return n(t,e),t.create=function(e,t,r){return new C(e,t,r)},t.prototype.next=function(e){this.isStopped?P(function(e){return _("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?P(_("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?P(R,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(y),S=Function.prototype.bind;function b(e,t){return S.call(e,t)}var N=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){I(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){I(e)}else I(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){I(e)}},e}(),C=function(e){function t(t,r,n){var s,o,i=e.call(this)||this;return h(t)||!t?s={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:i&&q.useDeprecatedNextContext?((o=Object.create(t)).unsubscribe=function(){return i.unsubscribe()},s={next:t.next&&b(t.next,o),error:t.error&&b(t.error,o),complete:t.complete&&b(t.complete,o)}):s=t,i.destination=new N(s),i}return n(t,e),t}(O);function I(e){var t;q.useDeprecatedSynchronousErrorHandling?(t=e,q.useDeprecatedSynchronousErrorHandling&&A&&(A.errorThrown=!0,A.error=t)):w(e)}function P(e,t){var r=q.onStoppedNotification;r&&v.setTimeout((function(){return r(e,t)}))}var L={closed:!0,next:T,error:function(e){throw e},complete:T},D="function"==typeof Symbol&&Symbol.observable||"@@observable";function M(e){return e}var k=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n,s=this,o=(n=e)&&n instanceof O||function(e){return e&&h(e.next)&&h(e.error)&&h(e.complete)}(n)&&m(n)?e:new C(e,t,r);return function(e){if(q.useDeprecatedSynchronousErrorHandling){var t=!A;if(t&&(A={errorThrown:!1,error:null}),e(),t){var r=A,n=r.errorThrown,s=r.error;if(A=null,n)throw s}}else e()}((function(){var e=s,t=e.operator,r=e.source;o.add(t?t.call(o,r):r?s._subscribe(o):s._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=x(t))((function(t,n){var s=new C({next:function(t){try{e(t)}catch(e){n(e),s.unsubscribe()}},error:n,complete:t});r.subscribe(s)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[D]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(r=e).length?M:1===r.length?r[0]:function(e){return r.reduce((function(e,t){return t(e)}),e)})(this);var r},e.prototype.toPromise=function(e){var t=this;return new(e=x(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function x(e){var t;return null!==(t=null!=e?e:q.Promise)&&void 0!==t?t:Promise}var U="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function F(e){if(e instanceof k)return e;if(null!=e){if(function(e){return h(e[D])}(e))return a=e,new k((function(e){var t=a[D]();if(h(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(f(e))return i=e,new k((function(e){for(var t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()}));if(h(null==(n=e)?void 0:n.then))return r=e,new k((function(e){r.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,w)}));if(function(e){return Symbol.asyncIterator&&h(null==e?void 0:e[Symbol.asyncIterator])}(e))return K(e);if(function(e){return h(null==e?void 0:e[U])}(e))return t=e,new k((function(e){var r,n;try{for(var s=o(t),i=s.next();!i.done;i=s.next()){var a=i.value;if(e.next(a),e.closed)return}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}e.complete()}));if(function(e){return h(null==e?void 0:e.getReader)}(e))return K(function(e){return function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(e,t||[]),o=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){s[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=s[e](t)).value instanceof l?Promise.resolve(r.value.v).then(u,c):f(o[0][2],r)}catch(e){f(o[0][3],e)}var r}function u(e){a("next",e)}function c(e){a("throw",e)}function f(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,(function(){var t,r,n;return s(this,(function(s){switch(s.label){case 0:t=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,l(t.read())];case 3:return r=s.sent(),n=r.value,r.done?[4,l(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,l(n)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e))}var t,r,n,i,a;throw function(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}(e)}function K(e){return new k((function(t){(function(e,t){var r,n,i,a,l,u,c,f;return l=this,u=void 0,f=function(){var l,u;return s(this,(function(s){switch(s.label){case 0:s.trys.push([0,5,6,11]),r=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=o(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,s){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,s,(t=e[r](t)).done,t.value)}))}}}(e),s.label=1;case 1:return[4,r.next()];case 2:if((n=s.sent()).done)return[3,4];if(l=n.value,t.next(l),t.closed)return[2];s.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=s.sent(),i={error:u},[3,11];case 6:return s.trys.push([6,,9,10]),n&&!n.done&&(a=r.return)?[4,a.call(r)]:[3,8];case 7:s.sent(),s.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((c=void 0)||(c=Promise))((function(e,t){function r(e){try{s(f.next(e))}catch(e){t(e)}}function n(e){try{s(f.throw(e))}catch(e){t(e)}}function s(t){var s;t.done?e(t.value):(s=t.value,s instanceof c?s:new c((function(e){e(s)}))).then(r,n)}s((f=f.apply(l,u||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}var V=function(e){function t(t,r,n,s,o,i){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=i,a._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=s?function(e){try{s(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return n(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(O);function B(e){return t=function(t,r){var n,s=null,o=!1;s=t.subscribe(new V(r,void 0,void 0,(function(i){n=F(e(i,B(e)(t))),s?(s.unsubscribe(),s=null,n.subscribe(r)):o=!0}),void 0)),o&&(s.unsubscribe(),s=null,n.subscribe(r))},function(e){if(function(e){return h(null==e?void 0:e.lift)}(e))return e.lift((function(e){try{return t(e,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")};var t}var H=u(980);const G={resourceName:"",resourceKind:"",adapterKind:"",resourceId:"",metric:""};var Y=u(177),j=u(705);function W(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const z={avg:e=>e.getAverage(),stddev:e=>e.getStandardDeviation(),min:e=>e.getMin(),max:e=>e.getMax(),sum:e=>e.getSum(),count:e=>e.getCount(),variance:e=>e.getVariance(),percentile:e=>e.getPercentile()};class X{addDataPoint(e){var t;this.sum+=e,this.count++,this.max=Math.max(this.max,e),this.min=Math.min(this.min,e);const r=this.sum/this.count;this.vAcc+=(e-this.avg)*(e-r),this.avg=r,null===(t=this.digest)||void 0===t||t.push(e)}getAverage(){return this.avg}getCount(){return this.count}getSum(){return this.sum}getMin(){return this.min}getMax(){return this.max}getVariance(){return this.count>1?this.vAcc/(this.count-1):0}getStandardDeviation(){return Math.sqrt(this.getVariance())}getPercentile(){return this.digest&&this.percentile?(this.digest.compress(),this.digest.percentile(this.percentile/100)):NaN}constructor(e,t){W(this,"sum",0),W(this,"count",0),W(this,"max",Number.MIN_VALUE),W(this,"min",Number.MAX_VALUE),W(this,"vAcc",0),W(this,"avg",0),W(this,"wantDigest",!1),W(this,"digest",void 0),W(this,"percentile",0),this.wantDigest=e,e&&(this.digest=new j.TDigest(.01)),this.percentile=t}}class Q{addDataPoint(e,t){let r=this.accumulators.get(e);r||(r=new X(this.wantPercentile,this.percentile),this.accumulators.set(e,r)),r.addDataPoint(t)}getResults(){return new Map([...this.accumulators.entries()].sort())}constructor(e,t){W(this,"accumulators",new Map),W(this,"wantPercentile",!1),W(this,"percentile",0),this.percentile=t,this.wantPercentile=e}}class ${add(e,t,r){const n=JSON.stringify(Array.from((null==r?void 0:r.entries())||{}));e.forEach(((r,s)=>{const o=e[s],i=t[s];let a=this.buckets.get(n);a||(a=new Q(this.wantPercentile,this.percentile),this.buckets.set(n,a)),a.addDataPoint(o,i)}))}toFrames(t,r,n){const s=z[r.type];if(!s)throw"Internal error: Producer "+r.type+" not found";const o=[];let i="<undefined>";for(const[r,a]of this.buckets){const l=n?n():null,u={};if(r){const e=JSON.parse(r);Object.entries(e).forEach((([e,t])=>{"$statKey"===e?i=t:u[e]=t}))}const c=new e.MutableDataFrame({refId:t,name:i,fields:[{name:"Time",type:e.FieldType.time},{name:"Value",type:e.FieldType.number,labels:u}]});if(l)for(const[e,t]of a.getResults()){const r=s(t),n=l.pushAndGet(e,r);c.add({Time:n.timestamp,Value:n.value})}else for(const[e,t]of a.getResults()){const r=s(t);c.add({Time:e,Value:r})}o.push(c)}return o}constructor(e){W(this,"wantPercentile",!1),W(this,"percentile",0),W(this,"buckets",new Map),"percentile"===e.type&&(this.wantPercentile=!0,this.percentile=e.parameter?e.parameter:0)}}var J=u(337),Z=u(8);function ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const te={mavg:(e,t,r)=>new ne(e,t,r),msum:(e,t,r)=>new se(e,t,r),mmedian:(e,t,r)=>new ce(e,t,r),mstddev:(e,t,r)=>new le(e,t,r),mvariance:(e,t,r)=>new ae(e,t,r),mmax:(e,t,r)=>new oe(e,t,r),mmin:(e,t,r)=>new ie(e,t,r),mexpavg:(e,t,r)=>new fe(e,r),mgaussian:(e,t,r)=>new pe(e,t,r)};class re{onPush(e){}onEvict(e){}push(e,t){const r={timestamp:e,value:t};this.head=(this.head+1)%this.nPoints;const n=this.buffer[this.head];this.buffer[this.head]={timestamp:e,value:t},this.onPush(r),n&&this.onEvict(n)}pushAndGet(e,t){return this.push(e,t),this.getValue()}getLatestTimestamp(){var e;return null===(e=this.buffer[this.head])||void 0===e?void 0:e.timestamp}makeSample(e){const t=this.adjustLag?this.lag/2:0;return{timestamp:this.buffer[this.head].timestamp-t,value:e}}getValue(){const e=this.buffer[this.head].timestamp;for(let t=0;t<this.nPoints;++t){const r=(t+1)%this.nPoints,n=this.buffer[r];if(n){if(n.timestamp>=e-this.lag)break;this.onEvict(n),this.buffer[r]=null}}return this._getValue()}constructor(e,t,r){ee(this,"buffer",void 0),ee(this,"nPoints",void 0),ee(this,"head",0),ee(this,"resolution",0),ee(this,"lag",0),ee(this,"adjustLag",void 0),ee(this,"totalTime",void 0),this.nPoints=Math.round(r.duration/e),this.totalTime=t,this.buffer=new Array(this.nPoints),this.resolution=e,this.lag=r.duration,this.adjustLag=r.shift}}class ne extends re{onPush(e){this.sum+=e.value,this.count++}onEvict(e){this.sum-=e.value,this.count--}_getValue(){return this.makeSample(this.sum/this.count)}constructor(...e){super(...e),ee(this,"sum",0),ee(this,"count",0)}}class se extends re{onPush(e){this.sum+=e.value}onEvict(e){this.sum-=e.value}_getValue(){return this.makeSample(this.sum)}constructor(...e){super(...e),ee(this,"sum",0)}}class oe extends re{onPush(e){this.heap.push(e.value)}onEvict(e){this.heap.top()===e.value&&this.heap.pop()}_getValue(){return this.makeSample(null!=this.heap.root()?this.heap.root():NaN)}constructor(...e){super(...e),ee(this,"heap",new Z.o$),ee(this,"filled",!1)}}class ie extends re{onPush(e){this.heap.push(e.value)}onEvict(e){this.heap.top()===e.value&&this.heap.pop()}_getValue(){return this.makeSample(null!=this.heap.root()?this.heap.root():NaN)}constructor(...e){super(...e),ee(this,"heap",new Z.H2),ee(this,"filled",!1)}}class ae extends re{onPush(e){if(this.full)return;this.count++,this.count>=this.nPoints&&(this.full=!0);const t=e.value;this.sum+=t;const r=this.sum/this.count;this.vAcc+=(t-this.avg)*(t-r),this.avg=r}onEvict(e){var t;const r=(null===(t=this.buffer[this.head])||void 0===t?void 0:t.value)||NaN,n=e.value,s=this.avg;this.avg=s+(r-n)/this.count,this.vAcc+=(r-n)*(r-this.avg+n-s)}getVariance(){return this.count>1?this.vAcc/(this.count-1):0}_getValue(){return this.makeSample(this.getVariance())}constructor(...e){super(...e),ee(this,"avg",0),ee(this,"vAcc",0),ee(this,"sum",0),ee(this,"count",0),ee(this,"full",!1)}}class le extends ae{_getValue(){return this.makeSample(Math.sqrt(this.getVariance()))}}class ue{push(e){var t;let r=null===(t=this.map.findKey(e))||void 0===t?void 0:t.getValue();null==r?(r={value:e,count:1},this.map.insert(r)):r.count++,this.size++}remove(e){var t;const r=null===(t=this.map.findKey(e))||void 0===t?void 0:t.getValue();return!!r&&(r.count--,0===r.count&&this.map.remove(r),this.size--,!0)}pop(){var e;const t=null===(e=this.map.min())||void 0===e?void 0:e.getValue();return t?(this.remove(t.value),t.value):null}top(){var e,t;return null===(t=this.map.min())||void 0===t||null===(e=t.getValue())||void 0===e?void 0:e.value}constructor(e){ee(this,"map",new J.AvlTree(((e,t)=>e.value-t.value),{key:"value"})),ee(this,"size",0),this.map=e?new J.AvlTree(((e,t)=>t.value-e.value),{key:"value"}):new J.AvlTree(((e,t)=>e.value-t.value),{key:"value"})}}class ce extends re{rebalance(){for(;this.maxHeap.size>this.minHeap.size+1;)this.minHeap.push(this.maxHeap.pop());for(;this.minHeap.size>this.maxHeap.size;)this.maxHeap.push(this.minHeap.pop())}onPush(e){const t=e.value;t<=this.maxHeap.top()?this.maxHeap.push(t):this.minHeap.push(t),this.rebalance()}onEvict(e){this.minHeap.remove(e.value)||this.maxHeap.remove(e.value),this.rebalance()}_getValue(){return 0===this.maxHeap.size?this.makeSample(NaN):this.minHeap.size===this.maxHeap.size?this.makeSample((this.minHeap.top()+this.maxHeap.top())/2):this.makeSample(this.maxHeap.top())}constructor(...e){super(...e),ee(this,"minHeap",new ue(!1)),ee(this,"maxHeap",new ue(!0))}}class fe{push(e,t){this.current=isNaN(this.current)?t:(1-this.alpha)*this.current+this.alpha*t,this.latestTimestamp=e}getValue(){return{value:this.current,timestamp:this.latestTimestamp-this.lag/2}}pushAndGet(e,t){return this.push(e,t),this.getValue()}constructor(e,t){ee(this,"alpha",void 0),ee(this,"current",NaN),ee(this,"latestTimestamp",0),ee(this,"lag",void 0),this.alpha=1-Math.exp(-e/t.duration),this.lag=t.shift?t.duration:0}}const he=Math.sqrt(2*Math.PI);class pe extends re{_getValue(){let e=0,t=0;const r=this.buffer[this.head].timestamp;for(let n=0;n<this.nPoints;n++){const s=this.buffer[(this.head+n+1)%this.nPoints];if(null==s)continue;const o=this.gaussian(s.timestamp-r+this.lag/2);e+=o,t+=o*s.value}return this.makeSample(t/e)}gaussian(e){return 1/(he*this.h)*Math.exp(-e*e/(2*this.h*this.h))}constructor(e,t,r){const n=r.duration;super(e,2*r.duration,r),ee(this,"sum",0),ee(this,"weightedSum",0),ee(this,"h",void 0),ee(this,"windowSize",void 0),this.windowSize=n,this.h=r.duration/2}}const ge=u(95),de=(e,t)=>{const r={conditions:[]};for(const t of e){if(t.conjunctive){if(r.conjunctionOperator&&t.conjunctive.toUpperCase()!==r.conjunctionOperator)throw`All terms must have the same conjunctive operator (and/or). Offending operator: ${t.conjunctive}`;r.conjunctionOperator=t.conjunctive.toUpperCase()}if("IN"===t.name)continue;const e={operator:t.name,key:t.arg[0]};if(t.arg.length>1){const r=t.arg[1];"number"==typeof r?e.doubleValue=r:e.stringValue=ye(r)}r.conditions.push(e)}if("OR"!==r.conjunctionOperator&&r.conjunctionOperator){for(const n of e)if("IN"===n.name&&r.conjunctionOperator&&"OR"!==r.conjunctionOperator){const e=n.arg[0],s=ye(n.arg[1]);if(console.log("argValues",s),r.conditions.push({operator:"EQ",key:e,stringValue:s[0]}),1===s.length)continue;t[e]||(t[e]=[]);for(const r of s)t[e].push(r)}}else for(const t of e)if("IN"===t.name){r.conjunctionOperator=t.conjunctive||"OR";for(const e of ye(t.arg[1]))r.conditions.push({operator:"EQ",key:t.arg[0],stringValue:e})}return r.conjunctionOperator||(r.conjunctionOperator="AND"),r},ye=e=>{if(!Array.isArray(e))return e;const t=[];for(const r of e)"string"==typeof r&&r.startsWith("{")&&r.endsWith("}")?t.push(...r.slice(1,r.length-1).split(",").map((e=>e.trim()))):t.push(r);return t},me=(e,r)=>{const n={adapterKind:[],regex:[],name:[],resourceId:[],resourceKind:[],resourceState:[],resourceHealth:[],resourceStatus:[]},s={},o={all:e=>{},regex:e=>{n.regex=e},name:e=>{(e=ye(e)).length>1?n.regex=[".*("+e.map((e=>(e=>{let t="";for(const r of e)"./*+[]{}()$^".includes(r)&&(t+="\\"),t+=r;return t})(e))).join("|")+").*"]:n.name=e},id:e=>{n.resourceId=e},whereProperties:e=>{n.propertyConditions=de(e,s)},whereMetrics:e=>{n.statConditions=de(e,s)},whereHealth:e=>{n.resourceHealth=ye(e)},whereState:e=>{n.resourceState=ye(e)},whereStatus:e=>{n.resourceStatus=ye(e)},whereTags:e=>{n.resourceTag=e.map((e=>{const t=e.split(":");if(2!==t.length)throw"Tags nust be specified on the form category:name";return{category:t[0],name:t[1]}}))}};if(e.advancedMode){const r=(0,t.getTemplateSrv)(),l=r?r.replace(e.queryText):e.queryText;console.log("interpolatedQ",l);const u=ge.parse(l),c=u.type;for(const e of c){var i,a;const t=e.split(":");null===(i=n.adapterKind)||void 0===i||i.push(t[0]),null===(a=n.resourceKind)||void 0===a||a.push(t[1])}const f=new Set;for(const e of u.instances){if(f.has(e.type))throw`Each filter is only allowed once. Offending filter: ${e.type}`;f.add(e.type),o[e.type](e.arg)}if(!u.metrics&&(u.aggregation||u.slidingWindow))throw"Aggregation/sliding window without .metrics() clause";const h=u.metrics,p=u.aggregation,g=u.slidingWindow;return{resourceQuery:n,orTerms:s,metrics:h,aggregation:p,slidingWindow:g}}{if(!e.resourceId)throw"No resource specified";const t={resourceId:[e.resourceId]};if(!e.metric)throw"No metric specified";const r=[e.metric];return{resourceQuery:t,orTerms:s,metrics:r}}},Ee=e=>{let t="";return e.adapterKind&&e.resourceKind&&(t+="resource("+e.adapterKind+":"+e.resourceKind+")"),e.resourceName&&(t+='.name("'+e.resourceName+'")'),e.metric&&(t+=".metrics("+e.metric+")"),t};function qe(e,t,r,n,s,o,i){try{var a=e[o](i),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,s)}function ve(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function i(e){qe(o,n,s,i,a,"next",e)}function a(e){qe(o,n,s,i,a,"throw",e)}i(void 0)}))}}function we(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Te extends Error{static buildMessage(e){let t=e.message;if(e.validationFailures){t+=" Details: ";for(const r of e.validationFailures)t+=r.failureMessage+". "}return t}constructor(e){super(Te.buildMessage(e))}}class Re extends e.DataSourceApi{request(e,r,n,s,o){var i=this;return ve((function*(){const a=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){we(e,t,r[t])}))}return e}({Accept:"application/json","Content-Type":"application/json",Authorization:s?yield i.getToken():""},o),l=yield(0,Y.lastValueFrom)((0,t.getBackendSrv)().fetch({method:e,url:(i.url||"")+r,data:n,headers:a,responseType:"text"}).pipe(B((e=>{console.log("err.data",e.data,typeof e.data);const t=e.data;if(null==t?void 0:t.message)throw new Te(t);throw`${e.status} : ${e.statusText}`}))));return JSON.parse(l.data,(function(e,t){if(!e.includes("-"))return t;this[e.replace("-","_")]=t}))}))()}post(e,t){return this.request("POST",e,t,!0)}get(e){return this.request("GET",e,null,!0)}getResources(e,t,r){var n=this;return ve((function*(){return n.getResourcesWithRq({adapterKind:[e],resourceKind:[t],name:r?[r]:void 0})}))()}getResourcesWithRq(e){var t=this;return ve((function*(){const r=yield t.post("resources/query?pageSize=1000",e);return new Map(r.resourceList.map((e=>[e.identifier,e.resourceKey.name])))}))()}getResourcesWithOrTerms(e,t){var r=this;return ve((function*(){var n;const s=yield r.getResourcesWithRq(e);if(t&&0===Object.keys(t).length)return yield r.getResourcesWithRq(e);e=JSON.parse(JSON.stringify(e));const o=new Map,i=(null===(n=e.propertyConditions)||void 0===n?void 0:n.conditions)||[];for(let e=0;e<i.length;e++){const t=i[e];o.set(t.key,e)}const a=[],l=Object.keys(t);for(const e in l)a.push(0);let u=0,c=!1;const f=[];for(;!c;){for(const e in a){const r=l[e],n=o.get(r);if(void 0===n)throw`Property ${r} not found in resource query`;const s=i[n],u=t[r][a[e]];s.stringValue=u}for(console.log("Querying with or-terms",JSON.stringify(e)),f.push(r.getResourcesWithRq(e).then((e=>{console.log("Records returned",e.size);for(const[t,r]of e)s.set(t,r);return e}))),u++,yield Promise.all(f),c=!0;;){for(let e=0;e<a.length;e++){if(a[e]++,a[e]<t[l[e]].length){c=!1;break}a[e]=0}break}}return console.log("Extra queries needed due to or-terms",u),s}))()}getAdapterKinds(){var e=this;return ve((function*(){const t=yield e.get("adapterkinds");return new Map(t.adapter_kind.map((e=>[e.key,e.name])))}))()}getResourceKinds(e){var t=this;return ve((function*(){const r=yield t.get("adapterkinds/"+e+"/resourcekinds");return new Map(r.resource_kind.map((e=>[e.key,e.name])))}))()}getStatKeysForResourceKind(e,t){var r=this;return ve((function*(){const n=yield r.get("adapterkinds/"+e+"/resourcekinds/"+t+"/statkeys");return new Map(n.resourceTypeAttributes.map((e=>[e.key,e.description])))}))()}getPropertiesForResourceKind(e,t){var r=this;return ve((function*(){const n=yield r.get("adapterkinds/"+e+"/resourcekinds/"+t+"/properties");return new Map(n.resourceTypeAttributes.map((e=>[e.key,e.description])))}))()}getPropertiesForResources(e,t){var r=this;return ve((function*(){const n={resourceIds:e,propertyKeys:t,instanced:!1},s=yield r.post("resources/properties/latest/query",n),o=new Map;for(const e of s.values){const t=new Map;o.set(e.resourceId,t);for(const r of e.property_contents.property_content)r.values?t.set(r.statKey,r.values[0]||"<undefined>"):r.data?t.set(r.statKey,r.data[0]||"<undefined>"):t.set(r.statKey,"<undefined>")}return o}))()}getAuthSources(){var e=this;return ve((function*(){const t=yield e.get("auth/sources");return new Map(t.sources.map((e=>[e.key,e.name])))}))()}framesFromResourceMetrics(t,r,n,s){const o=[],i=n.resourceId;for(const a of n.stat_list.stat){const n={resourceName:r.get(i)||"unknown"},l=new e.MutableDataFrame({refId:t,name:a.statKey.key,fields:[{name:"Time",type:e.FieldType.time},{name:"Value",type:e.FieldType.number,labels:n}]});if(o.push(l),s){const e=s();a.timestamps.forEach(((t,r)=>{const n=e.pushAndGet(t,a.data[r]);l.add({Time:n.timestamp,Value:n.value})}))}else a.timestamps.forEach(((e,t)=>{l.add({Time:a.timestamps[t],Value:a.data[t]})}))}return o}getMetrics(e,t,r,n,s,o,i,a){var l=this;return ve((function*(){var u;const c=Math.max((s-n)/(6e4*o),5),f=a?()=>te[a.type](6e4*c,s-n,a.params):null,h=(null==a||null===(u=a.params)||void 0===u?void 0:u.shift)?a.params.duration:0,p={resourceId:[...t.keys()],statKey:r,begin:n.toFixed(0),end:(s+h).toFixed(0),rollUpType:"AVG",intervalType:"MINUTES",intervalQuantifier:c.toFixed(0)},g=yield l.post("resources/stats/query",p);if(i){let t=new Map;i.properties&&(t=yield l.getPropertiesForResources(g.values.map((e=>e.resourceId)),i.properties));const r=new $(i);for(const e of g.values)for(const n of e.stat_list.stat){const s=t.get(e.resourceId)||new Map;s.set("$statKey",n.statKey.key),r.add(n.timestamps,n.data,s)}return r.toFrames(e,i,f)}return g.values.map((r=>l.framesFromResourceMetrics(e,t,r,f))).flat()}))()}authenticateSaaS(){var e=this;return ve((function*(){return"CSPToken "+(yield e.request("POST","csp/authorize","",!1,{"Content-Type":"application/x-www-form-urlencoded"})).access_token}))()}authenticateOnPrem(e){var t=this;return ve((function*(){const r={username:e.username},n=e.authSource&&"Local Users"!==e.authSource?"auth/token/acquire-withsource":"auth/token/acquire";return"vRealizeOpsToken "+(yield t.request("POST",n,r,!1)).token}))()}authenticate(e){var t=this;return ve((function*(){try{t.token=e.isSaaS?yield t.authenticateSaaS():yield t.authenticateOnPrem(e),setTimeout((()=>{t.authenticate(e)}),Re.EXPIRATION_TIME),t.authWaiters.forEach((e=>e.resolve(t.token||""))),t.authWaiters=[]}catch(e){t.authWaiters.forEach((t=>t.reject(e)))}}))()}getToken(){return new Promise(((e,t)=>{this.token?e(this.token):this.authWaiters.push({resolve:e,reject:t})}))}metricFindQuery(e,t){var r=this;return ve((function*(){if(!(null==e?void 0:e.query)||""===e.query)return[];const n={advancedMode:!0,queryText:e.query,refId:""};console.log("findMetricQuery",n);const s=me(n,t.scopedVars),o=yield r.getResourcesWithOrTerms(s.resourceQuery,s.orTerms||{}),i=[];return o.forEach(((e,t)=>{i.push({text:e,value:e})})),i}))()}query(e){var t=this;return ve((function*(){const{range:r,maxDataPoints:n}=e,s=r.from.valueOf(),o=r.to.valueOf(),i=[];for(const r of e.targets){if(r.hide)continue;const a=(0,H.defaults)(r,G);if(console.log("Query",a),!(a.advancedMode||a.adapterKind&&a.resourceId&&a.resourceKind&&a.metric))continue;const l=me(a,e.scopedVars);console.log("Compiled Query adter compile",JSON.stringify(l),a);const u=yield t.getResourcesWithOrTerms(l.resourceQuery,l.orTerms||{});(u&&u.size>0?yield t.getMetrics(a.refId,u,l.metrics,s,o,n||1e4,l.aggregation,l.slidingWindow):[]).forEach((e=>i.push(e)))}return{data:i}}))()}testDatasource(){var e=this;return ve((function*(){try{const t=yield e.getAdapterKinds();if(!t||0===t.size)return{status:"failure",message:"Was able to connect, but getAdapterKinds returned nothing. Check that backend Aria Operations is healthy"}}catch(e){return{status:"error",message:"string"==typeof e?e:e instanceof Error?e.message:"Unspecified error"}}return{status:"success",message:"Success"}}))()}constructor(e){super(e),we(this,"authWaiters",[]),we(this,"token",void 0),we(this,"url",void 0),this.url=(e.url||"")+"/aria-operations/suite-api/api/",this.authenticate(e.jsonData)}}we(Re,"EXPIRATION_TIME",9e5);var _e=u(650),Ae=u.n(_e),Oe=u(388);function Se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Se(e,t,r[t])}))}return e}function Ne(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const{SecretFormField:Ce,FormField:Ie}=Oe.LegacyForms,Pe="www.mgmt.cloud.vmware.com/vrops-cloud";class Le extends _e.PureComponent{render(){const{options:e}=this.props,{jsonData:t,secureJsonFields:r}=e,n=e.secureJsonData||{},s=t.isSaaS?Ae().createElement("div",null,Ae().createElement("div",{className:"gf-form"},Ae().createElement(Ie,{label:"SaaS Region (blank for US)",labelWidth:20,inputWidth:20,onChange:this.onRegionChange,value:t.saasRegion||"",placeholder:"Aria Operations SaaS Region"})),Ae().createElement("div",{className:"gf-form"},Ae().createElement(Ce,{isConfigured:r&&r.password,value:n.password||"",label:"API Key",placeholder:"Aria Operations API Key",labelWidth:20,inputWidth:20,onReset:this.onResetPassword,onChange:this.onPasswordChange}))):Ae().createElement("div",null,Ae().createElement("div",{className:"gf-form"},Ae().createElement(Ie,{label:"Aria Ops Host",labelWidth:20,inputWidth:20,onChange:this.onHostChange,value:t.host||"",placeholder:"Aria Operations Host or IP"})),Ae().createElement("div",{className:"gf-form"},Ae().createElement(Ie,{label:"Username",labelWidth:20,inputWidth:20,onChange:this.onUsernameChange,value:t.username||"",placeholder:"Aria Operations Username"})),Ae().createElement("div",{className:"gf-form"},Ae().createElement(Ce,{isConfigured:r&&r.password,value:n.password||"",label:"Password",placeholder:"Aria Operations Password",labelWidth:20,inputWidth:20,onReset:this.onResetPassword,onChange:this.onPasswordChange})),Ae().createElement("div",{className:"gf-form"},Ae().createElement(Ie,{label:"Authentication Source",labelWidth:20,inputWidth:20,onChange:this.onAuthSourceChange,value:t.authSource||"Local Users",placeholder:"Aria Operations Authentication Source"})),Ae().createElement("div",{className:"gf-form"},Ae().createElement(Ie,{label:"Skip TLS verify (UNSAFE!)",labelWidth:20,inputWidth:20,onChange:this.onSkipVerifyChange,checked:t.tlsSkipVerify,placeholder:"Skip TLS verify",type:"checkbox"})));return Ae().createElement("div",{className:"gf-form-group"},Ae().createElement(Ie,{label:"Connecting to SaaS instance?",labelWidth:20,inputWidth:20,onChange:this.onSaaSChange,checked:t.isSaaS,placeholder:"SaaS instance",type:"checkbox"}),s)}constructor(...e){super(...e),Se(this,"onSaaSChange",(e=>{const{onOptionsChange:t,options:r}=this.props,n=Ne(be({},r.jsonData),{isSaaS:e.target.checked});t(Ne(be({},r),{jsonData:n}))})),Se(this,"onRegionChange",(e=>{const{onOptionsChange:t,options:r}=this.props,n=e.target.value,s=Ne(be({},r.jsonData),{saasRegion:n,host:n&&"us"!==n?n+"."+Pe:Pe});t(Ne(be({},r),{jsonData:s}))})),Se(this,"onHostChange",(e=>{const{onOptionsChange:t,options:r}=this.props,n=Ne(be({},r.jsonData),{host:e.target.value});t(Ne(be({},r),{jsonData:n}))})),Se(this,"onUsernameChange",(e=>{const{onOptionsChange:t,options:r}=this.props,n=Ne(be({},r.jsonData),{username:e.target.value});t(Ne(be({},r),{jsonData:n}))})),Se(this,"onAuthSourceChange",(e=>{const{onOptionsChange:t,options:r}=this.props,n=Ne(be({},r.jsonData),{authSource:e.target.value});t(Ne(be({},r),{jsonData:n}))})),Se(this,"onSkipVerifyChange",(e=>{const{onOptionsChange:t,options:r}=this.props,n=Ne(be({},r.jsonData),{tlsSkipVerify:e.target.checked});t(Ne(be({},r),{jsonData:n}))})),Se(this,"onPasswordChange",(e=>{const{onOptionsChange:t,options:r}=this.props;t(Ne(be({},r),{secureJsonData:{password:e.target.value}}))})),Se(this,"onResetPassword",(()=>{const{onOptionsChange:e,options:t}=this.props;e(Ne(be({},t),{secureJsonFields:Ne(be({},t.secureJsonFields),{password:!1}),secureJsonData:Ne(be({},t.secureJsonData),{password:""})}))}))}}var De=u(988);const Me=e=>{const t=[];for(const[r,n]of e)t.push({value:r,label:n});return t},ke="aria-operations",xe=["resource","all","regex","name","id","whereProperties","whereMetrics","metrics","not","and","or","contains","not","exists","starts_with","ends_with","whereHealth","whereState","whereStatus","whereTags","avg","stddev","sum","min","max","count","variance","percentile","mavg","mmax","mmin","mmedian","mstddev","mvariance","msum","mexpavg","mgaussian"];function Ue(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Fe=["STOPPED","STARTING","STARTED","STOPPING","UPDATING","FAILED","MAINTAINED","MAINTAINED_MANUAL","REMOVING","NOT_EXISTING","NONE","UNKNOWN"],Ke=["NONE","ERROR","UNKNOWN","DOWN","DATA_RECEIVING","OLD_DATA_RECEIVING","NO_DATA_RECEIVING","NO_PARENT_MONITORING","COLLECTOR_DOWN"],Ve=["GREEN","YELLOW","ORANGE","RED","GREY"];class Be{preLoadResourceTypes(){const e=[];this.datasource.getAdapterKinds().then((t=>{for(const r of t.keys())this.datasource.getResourceKinds(r).then((t=>{for(const n of t.keys())e.push(r+":"+n)})).catch((e=>console.log("Could not load resource kinds for ")+e))})),this.resourceKinds=e}inferResourceType(e){const t=e.match(/\s*resource\(([^)]+)/);return t&&t.at(1)||""}makeCompletionItem(e,t,r){return{label:e,range:t,detail:r,insertText:e.includes(" ")?"`"+e+"`":e,kind:this.monaco.languages.CompletionItemKind.Function}}provideCompletionItems(e,t,r,n){const s=e.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:t.lineNumber,endColumn:t.column}),o=s.match(/([A-Za-z0-9_$:|]+)$/);if(!o)return{suggestions:[]};const i={word:o[1],endColumn:t.column,startColumn:t.column-o[1].length},a={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:i.startColumn,endColumn:i.endColumn};if(s.match(/\)\s*\.\s*[^()]*$/)||s.match(/^\s*[^()]*$/))return{suggestions:xe.map((e=>this.makeCompletionItem(e,a)))};let l=-1,u=null;for(const e in this.keywords){const t=s.lastIndexOf(e);t>l&&(l=t,u=this.keywords[e])}return u?u(s,a):{suggestions:[]}}resolveCompletionItem(e,t){return null}constructor(e,t){Ue(this,"datasource",void 0),Ue(this,"monaco",void 0),Ue(this,"resourceKinds",void 0),Ue(this,"metricNameCache",new Map),Ue(this,"propertyNameCache",new Map),Ue(this,"triggerCharacters",void 0),Ue(this,"handleMetric",((e,t)=>{const r=this.inferResourceType(e),n=this.metricNameCache.get(r);return n?Promise.resolve({suggestions:n.map((e=>this.makeCompletionItem(e[0],t,e[1])))}):new Promise(((e,n)=>{const s=r.split(":");this.datasource.getStatKeysForResourceKind(s[0],s[1]).then((n=>{const s=[];for(const e in n)s.push(this.makeCompletionItem(e,t,n.get(e)));this.metricNameCache.set(r,[...n.entries()]),e({suggestions:s})}))}))})),Ue(this,"handleProperty",((e,t)=>{const r=this.inferResourceType(e),n=this.propertyNameCache.get(r);return n?Promise.resolve({suggestions:n.map((e=>this.makeCompletionItem(e[0],t,e[1])))}):new Promise(((e,n)=>{const s=r.split(":");this.datasource.getPropertiesForResourceKind(s[0],s[1]).then((n=>{const s=[];for(const e in n)s.push(this.makeCompletionItem(e,t,n.get(e)));this.propertyNameCache.set(r,[...n.entries()]),e({suggestions:s})}))}))})),Ue(this,"handleResource",((e,t)=>{var r;return{suggestions:(null===(r=this.resourceKinds)||void 0===r?void 0:r.map((e=>this.makeCompletionItem(e,t))))||[]}})),Ue(this,"handleHealth",((e,t)=>({suggestions:Ve.map((e=>this.makeCompletionItem(e,t)))||[]}))),Ue(this,"handleState",((e,t)=>({suggestions:Fe.map((e=>this.makeCompletionItem(e,t)))||[]}))),Ue(this,"handleStatus",((e,t)=>({suggestions:Ke.map((e=>this.makeCompletionItem(e,t)))||[]}))),Ue(this,"handleDefault",((e,t)=>({suggestions:[]}))),Ue(this,"keywords",{resource:this.handleResource,whereMetrics:this.handleMetric,whereProperties:this.handleProperty,whereHealth:this.handleHealth,whereState:this.handleState,whereStatus:this.handleStatus,metrics:this.handleMetric,id:this.handleDefault,name:this.handleDefault,regex:this.handleDefault,avg:this.handleProperty,sum:this.handleProperty,min:this.handleProperty,max:this.handleProperty,stddev:this.handleProperty,count:this.handleProperty,variance:this.handleProperty,percentile:this.handleProperty}),this.datasource=e,this.monaco=t,this.resourceKinds&&0!==this.resourceKinds.length||this.preLoadResourceTypes()}}const He={keywords:xe,typeKeywords:[],operators:["=",">","<","=","<=",">=","!="],symbols:/[=><!~?:&|+\-*\/\^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,tokenizer:{root:[[/[a-z_$:|][\w$]*/,{cases:{"@typeKeywords":"keyword","@keywords":"keyword","@default":"identifier"}}],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F]+/,"number.hex"],[/\d+/,"number"],[/[;,.]/,"delimiter"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/"/,{token:"string.quote",bracket:"@open",next:"@string"}],[/'[^\\']'/,"string"],[/(')(@escapes)(')/,["string","string.escape","string"]],[/'/,"string.invalid"]],comment:[[/[^\/*]+/,"comment"],[/\/\*/,"comment","@push"],["\\*/","comment","@pop"],[/[\/*]/,"comment"]],string:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,{token:"string.quote",bracket:"@close",next:"@pop"}]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\*/,"comment","@comment"],[/\/\/.*$/,"comment"]]}};function Ge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ye extends _e.PureComponent{render(){return Ae().createElement(Oe.ReactMonacoEditor,{onChange:(0,H.debounce)(this.onQueryTextChange,300),value:this.props.query.queryText,height:200,onMount:this.onMonacoMount,language:"aria-operations",options:{readOnly:!this.props.advancedMode,minimap:{enabled:!1}}})}constructor(e){super(e),Ge(this,"editor",void 0),Ge(this,"onMonacoMount",((e,t)=>{e.onDidBlurEditorWidget(this.onBlur),t.languages.getLanguages().some((e=>e.id===ke))||(t.languages.register({id:ke}),t.languages.setMonarchTokensProvider(ke,He),t.languages.registerCompletionItemProvider(ke,new Be(this.props.datasource,t)))})),Ge(this,"onQueryTextChange",(e=>{const{onChange:t}=this.props;this.props.query.queryText=e,t(e||"")})),Ge(this,"onBlur",(e=>{this.props.onBlur&&(console.log("eeeee",e),this.props.onBlur())}))}}function je(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){je(e,t,r[t])}))}return e}function ze(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const{FormField:Xe}=Oe.LegacyForms;class Qe extends _e.PureComponent{loadResourceOptions(e,t,r){this.props.datasource.getResources(e,t,r).then((e=>{this.setState({resources:Me(e)})}))}loadResourceKindOptions(e){this.props.datasource.getResourceKinds(e).then((e=>{this.setState({resourceKinds:Me(e)})}))}loadMetricOptions(e,t){this.props.datasource.getStatKeysForResourceKind(e,t).then((e=>{const t=[];for(const[r,n]of e)t.push({value:r,label:r+": "+n});t.sort(((e,t)=>(e.label||"").toLocaleLowerCase()>(t.label||"").toLocaleLowerCase()?1:-1)),this.setState({metrics:t})}))}loadAdapterKindOptions(){this.props.datasource.getAdapterKinds().then((e=>{const t=Me(e);t.sort(((e,t)=>(e.label||"").toLocaleLowerCase()>(t.label||"").toLocaleLowerCase()?1:-1)),this.setState({adapterKinds:t})}))}render(){const e=this.props,{resourceId:t,metric:r,adapterKind:n,resourceKind:s,queryText:o,advancedMode:i}=e.query;return Ae().createElement("div",{className:"gf-form"},Ae().createElement(De.EditorRows,null,Ae().createElement(De.EditorRow,null,Ae().createElement(Oe.Select,{width:30,placeholder:"Choose Adapter Kind...",onChange:this.onAdapterKindChange,value:n,options:this.state.adapterKinds,disabled:0===this.state.adapterKinds.length}),Ae().createElement(Oe.Select,{width:30,placeholder:"Choose Resource Kind...",onChange:this.onResourceKindChange,value:s,options:this.state.resourceKinds,disabled:0===this.state.resourceKinds.length}),Ae().createElement(Oe.Select,{width:30,placeholder:"Choose Resource...",onChange:this.onResourceIdChange,value:t,options:this.state.resources,onInputChange:(0,H.debounce)(this.onResourceInputChange,300),disabled:0===this.state.resources.length}),Ae().createElement(Oe.Select,{width:30,placeholder:"Choose Metric...",onChange:this.onMetricChange,value:r,options:this.state.metrics,disabled:0===this.state.metrics.length}),Ae().createElement(Xe,{label:"Advanced mode",labelWidth:10,inputWidth:10,onChange:this.onAdvancedModeChange,checked:i,placeholder:"Advanced Mode",type:"checkbox"})),Ae().createElement(De.EditorRow,null,Ae().createElement(Ye,{datasource:this.props.datasource,query:{queryText:o},onChange:this.onQueryTextChange,advancedMode:i}))))}constructor(e){super(e),je(this,"editor",void 0),je(this,"onQueryTextChange",(e=>{const{onChange:t,query:r}=this.props;r.queryText=e,t(ze(We({},r),{queryText:e}))})),je(this,"onResourceIdChange",((e,t)=>{const{onChange:r,query:n}=this.props;r(ze(We({},n),{resourceId:e.value||"",resourceName:e.label||""}))})),je(this,"onResourceInputChange",((e,t)=>{const{query:r}=this.props;r.adapterKind&&r.resourceKind&&this.loadResourceOptions(r.adapterKind,r.resourceKind,e)})),je(this,"onAdapterKindChange",((e,t)=>{const{onChange:r,query:n}=this.props;this.loadResourceKindOptions(e.value||""),n.advancedMode||(n.queryText=Ee(n)),r(ze(We({},n),{adapterKind:e.value||""}))})),je(this,"onResourceKindChange",((e,t)=>{const{onChange:r,query:n}=this.props;n.adapterKind&&(this.loadResourceOptions(n.adapterKind,e.value||""),this.loadMetricOptions(n.adapterKind,e.value||"")),r(ze(We({},n),{resourceKind:e.value||""}))})),je(this,"onMetricChange",((e,t)=>{const{onChange:r,query:n}=this.props;r(ze(We({},n),{metric:e.value||""}))})),je(this,"onAdvancedModeChange",(e=>{const{onChange:t,query:r}=this.props,n=e.target.checked&&!r.queryText?Ee(r):r.queryText;t(ze(We({},r),{advancedMode:e.target.checked,queryText:n}))})),this.state={adapterKinds:[],resourceKinds:[],resources:[],metrics:[]},this.loadAdapterKindOptions();const{query:t}=this.props;t.adapterKind&&(this.loadResourceKindOptions(t.adapterKind),t.resourceKind&&(this.loadResourceOptions(t.adapterKind,t.resourceKind),this.loadMetricOptions(t.adapterKind,t.resourceKind)))}}function $e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Je=new e.DataSourcePlugin(Re).setConfigEditor(Le).setVariableQueryEditor((({onChange:e,query:t,datasource:r})=>{const[n,s]=(0,_e.useState)(t);return Ae().createElement(Ae().Fragment,null,Ae().createElement("div",{className:"gf-form"},Ae().createElement(Ye,{advancedMode:!0,datasource:r,query:{queryText:t.query},onChange:e=>{var t,r;s((t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){$e(e,t,r[t])}))}return e}({},n),r=null!=(r={query:e})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t))},onBlur:()=>{e(n,n.query)}})))})).setQueryEditor(Qe)})(),c})()));
//# sourceMappingURL=module.js.map